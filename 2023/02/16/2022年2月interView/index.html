
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
  <meta name="keywords" content="胡小黑,架构师,资深软件工程师,object-c,swift,java,node,小黑,技术,大牛,阿里巴巴,腾讯,旅游">
  
  
    <title>2022年2月interView | 小黑的技术博客</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="sam">
    
    <meta name="baidu-site-verification" content="zBj0BDqjSV" />
    
    <meta name="description" content="2022年2月interView做总结，复习，学习。。。。。。  java所有问题基于jdk1.8  jvm的两种回收机制，cms和g1的工作原理及区别 cms  暂停性内存回收，采用标记–清除算法, 块状清理，容易产生更多碎片。 gc运行时将使所有线程挂起，导致系统服务出现短暂停止。  g1  jdk1.7推出，采用并行、并发标记整理算法，可预测停顿，产生更少的碎片, 以网格方式进行gc分析处理">
<meta property="og:type" content="article">
<meta property="og:title" content="2022年2月interView">
<meta property="og:url" content="http://clockcoder.com/2023/02/16/2022%E5%B9%B42%E6%9C%88interView/index.html">
<meta property="og:site_name" content="小黑的技术博客">
<meta property="og:description" content="2022年2月interView做总结，复习，学习。。。。。。  java所有问题基于jdk1.8  jvm的两种回收机制，cms和g1的工作原理及区别 cms  暂停性内存回收，采用标记–清除算法, 块状清理，容易产生更多碎片。 gc运行时将使所有线程挂起，导致系统服务出现短暂停止。  g1  jdk1.7推出，采用并行、并发标记整理算法，可预测停顿，产生更少的碎片, 以网格方式进行gc分析处理">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://clockcoder.com/images/e6c9d24ely1h04204eo2vj20yk0k0jrz.png">
<meta property="og:image" content="http://clockcoder.com/images/e6c9d24ely1gzwiv87544j20p40t6jt4.png">
<meta property="article:published_time" content="2023-02-16T11:41:06.911Z">
<meta property="article:modified_time" content="2023-02-16T11:41:06.912Z">
<meta property="article:author" content="sam">
<meta property="article:tag" content="题目">
<meta property="article:tag" content="review">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://clockcoder.com/images/e6c9d24ely1h04204eo2vj20yk0k0jrz.png">
<meta name="twitter:creator" content="@XiaoheiSpring">
<link rel="publisher" href="109318125124422212783">

    
    <link rel="alternative" href="/atom.xml" title="小黑的技术博客" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    
<link rel="stylesheet" href="/css/style.css">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7265659350794760"
     crossorigin="anonymous"></script>
<meta name="generator" content="Hexo 6.3.0"></head>

  <body>
    <header>
      
<div>

		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="小黑的技术博客" title="小黑的技术博客"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="小黑的技术博客">小黑的技术博客</a></h1>
				<h2 class="blog-motto">不积跬步无以至千里</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">主页</a></li>
					
						<li><a href="/archives">归档</a></li>
					
						<li><a href="/about">关于</a></li>
					
					<li><a href="http://clockcoder.com">副站</a></li>
					<li>
 					
						<form class="search" action="/search/index.html" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="text" id="search" autocomplete="on" class="st-default-search-input"  name="q" maxlength="30" placeholder="搜索" />
					</form>
					
					</li>
				</ul>
			</nav>			
</div>

    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2023/02/16/2022年2月interView/" title="2022年2月interView" itemprop="url">2022年2月interView</a>
  </h1>
  <p class="article-author">By
       
		<a href="https://plus.google.com/109318125124422212783?rel=author" title="sam" target="_blank" itemprop="author">sam</a>
		
  <p class="article-time">
    <time datetime="2023-02-16T11:41:06.911Z" itemprop="datePublished"> 发表于 2023-02-16</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		
			<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#2022%E5%B9%B42%E6%9C%88interView"><span class="toc-number">1.</span> <span class="toc-text">2022年2月interView</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#jvm%E7%9A%84%E4%B8%A4%E7%A7%8D%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6%EF%BC%8Ccms%E5%92%8Cg1%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86%E5%8F%8A%E5%8C%BA%E5%88%AB"><span class="toc-number">1.1.</span> <span class="toc-text">jvm的两种回收机制，cms和g1的工作原理及区别</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JVM%E8%BF%90%E8%A1%8C%E4%B8%AD%E6%96%B0%E7%94%9F%E4%BB%A3%E5%AF%B9%E8%B1%A1%E5%9C%A8%E4%BB%80%E4%B9%88%E6%83%85%E5%86%B5%E4%B8%8B%EF%BC%8C%E4%BC%9A%E8%A2%AB%E4%B8%8A%E5%8D%87%E5%88%B0%E8%80%81%E5%B9%B4%E4%BB%A3%EF%BC%9F"><span class="toc-number">1.2.</span> <span class="toc-text">JVM运行中新生代对象在什么情况下，会被上升到老年代？</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%8E%E4%B9%88%E5%88%A4%E6%96%AD%E5%AF%B9%E8%B1%A1%E5%8F%AF%E5%9B%9E%E6%94%B6"><span class="toc-number">1.2.1.</span> <span class="toc-text">怎么判断对象可回收</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A0%86%E4%B8%AD%E6%9C%89%E5%AF%B9%E8%B1%A1%E5%8F%AF%E5%9B%9E%E6%94%B6%E6%97%B6%EF%BC%8C%E8%A7%A6%E5%8F%91%E7%9A%84%E5%93%AA%E7%A7%8D%E6%9C%BA%E5%88%B6%E5%9B%9E%E6%94%B6"><span class="toc-number">1.2.2.</span> <span class="toc-text">堆中有对象可回收时，触发的哪种机制回收</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#gc%E6%97%B6%E9%87%87%E7%94%A8%E7%9A%84%E7%AE%97%E6%B3%95"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">gc时采用的算法</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JVM%E6%98%AF%E5%A6%82%E4%BD%95%E4%B8%8Ecpu%E3%80%81%E5%86%85%E5%AD%98%E8%BF%9B%E8%A1%8C%E8%B0%83%E5%BA%A6%E4%BA%A4%E4%BA%92%E7%9A%84"><span class="toc-number">1.3.</span> <span class="toc-text">JVM是如何与cpu、内存进行调度交互的?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%89%E4%B8%AA%E7%A7%92%E6%9D%80%E6%8E%A5%E5%8F%A3%EF%BC%8C%E6%8E%A5%E5%8F%A3%E4%B8%AD%E9%97%B4%E8%B0%83%E7%94%A8%E4%BA%86%E5%87%A0%E4%B8%AA%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%8E%A5%E5%8F%A3%EF%BC%8C%E5%8E%9F%E6%9D%A5%E6%94%AF%E6%8C%811000%E4%B8%AAQPS-%E7%8E%B0%E5%9C%A8%E8%A6%81%E6%B1%82%E4%BC%98%E5%8C%96%EF%BC%8C%E5%B0%86QPS%E6%8F%90%E5%8D%87%E5%88%B01%E4%B8%87-%EF%BC%8C%E6%80%8E%E4%B9%88%E4%BC%98%E5%8C%96"><span class="toc-number">1.4.</span> <span class="toc-text">有个秒杀接口，接口中间调用了几个微服务接口，原来支持1000个QPS, 现在要求优化，将QPS提升到1万+，怎么优化?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%A5%E4%BD%9C%E4%B8%AD%E6%9C%89%E8%A7%A3%E5%86%B3%E8%BF%87%E4%BB%80%E4%B9%88%E9%97%AE%E9%A2%98%EF%BC%8C%E8%A7%A3%E5%86%B3%E6%80%9D%E8%B7%AF%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-number">1.5.</span> <span class="toc-text">工作中有解决过什么问题，解决思路是什么?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E9%87%8D%E5%90%AF%E9%97%AE%E9%A2%98"><span class="toc-number">1.5.1.</span> <span class="toc-text">应用重启问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8C%85%E5%86%B2%E7%AA%81%E5%AF%BC%E8%87%B4%E5%BA%94%E7%94%A8%E8%AE%BF%E9%97%AE%E5%BC%82%E5%B8%B8%E9%97%AE%E9%A2%98"><span class="toc-number">1.5.2.</span> <span class="toc-text">包冲突导致应用访问异常问题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83%E6%8A%80%E6%9C%AF%E9%80%89%E5%9E%8B%EF%BC%8C%E5%90%84%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83%E7%9A%84%E5%8C%BA%E5%88%AB%E4%B8%8E%E4%BC%98%E7%BC%BA%E7%82%B9%EF%BC%8C%E4%B8%BA%E4%BB%80%E4%B9%88%E6%9C%80%E7%BB%88%E9%80%89%E6%8B%A9%E4%BA%86%E9%82%A3%E4%B8%AA"><span class="toc-number">1.6.</span> <span class="toc-text">配置中心技术选型，各配置中心的区别与优缺点，为什么最终选择了那个?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#nacos"><span class="toc-number">1.6.1.</span> <span class="toc-text">nacos</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#apollo"><span class="toc-number">1.6.2.</span> <span class="toc-text">apollo</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#discover-server"><span class="toc-number">1.6.3.</span> <span class="toc-text">discover server</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%89%E4%B8%A4%E4%B8%AAList-%E6%AF%8F%E4%B8%AAlist%E9%83%BD%E6%9C%89100w%E6%9D%A1%E6%95%B0%E6%8D%AE%EF%BC%8C%E7%8E%B0%E5%9C%A8%E8%A6%81%E5%B0%86%E4%B8%A4%E4%B8%AAlist%E4%B8%AD%E7%9A%84%E9%87%8D%E5%A4%8D%E6%95%B0%E6%8D%AE%E5%8F%96%E5%87%BA%E6%9D%A5%EF%BC%8C%E6%9C%89%E4%BB%80%E4%B9%88%E5%8A%9E%E6%B3%95-%E4%B9%9F%E5%8F%AF%E4%BB%A5%E5%80%9F%E5%8A%A9%E7%AC%AC%E4%B8%89%E6%96%B9%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%AE%9E%E7%8E%B0-%EF%BC%9F"><span class="toc-number">1.7.</span> <span class="toc-text">有两个List,每个list都有100w条数据，现在要将两个list中的重复数据取出来，有什么办法(也可以借助第三方中间件实现)？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rabbiMQ-%E9%85%8D%E7%BD%AE%E9%97%AE%E9%A2%98"><span class="toc-number">1.8.</span> <span class="toc-text">rabbiMQ 配置问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E7%BD%AE"><span class="toc-number">1.8.1.</span> <span class="toc-text">服务端配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9B%86%E7%BE%A4%E7%9B%B8%E5%85%B3%E9%85%8D%E7%BD%AE"><span class="toc-number">1.8.1.1.</span> <span class="toc-text">集群相关配置</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#cluster-partition-handling"><span class="toc-number">1.8.1.1.1.</span> <span class="toc-text">cluster_partition_handling</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E5%A4%84%E7%90%86rabbitMQ%E9%9B%86%E7%BE%A4%E8%84%91%E8%A3%82%E9%97%AE%E9%A2%98"><span class="toc-number">1.8.1.1.1.1.</span> <span class="toc-text">如何处理rabbitMQ集群脑裂问题</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#mirroring-sync-batch-size"><span class="toc-number">1.8.1.1.2.</span> <span class="toc-text">mirroring_sync_batch_size</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#rabbitMQ%E9%9B%86%E7%BE%A4%E5%8F%91%E7%8E%B0%E6%9C%BA%E5%88%B6"><span class="toc-number">1.8.1.1.3.</span> <span class="toc-text">rabbitMQ集群发现机制</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AE"><span class="toc-number">1.8.2.</span> <span class="toc-text">客户端配置</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rabbitMQ-%E6%80%8E%E4%B9%88%E4%BF%9D%E8%AF%81100-%E6%B6%88%E6%81%AF%E4%B8%8D%E4%B8%A2%E5%A4%B1"><span class="toc-number">1.9.</span> <span class="toc-text">rabbitMQ 怎么保证100%消息不丢失?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%A0%E4%BB%AC%E5%BE%AE%E6%9C%8D%E5%8A%A1%E7%B3%BB%E7%BB%9F%E4%B8%BB%E8%A6%81%E4%BD%BF%E7%94%A8%E4%BA%86%E5%93%AA%E4%BA%9B%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.10.</span> <span class="toc-text">你们微服务系统主要使用了哪些监控系统</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%93%BE%E8%B7%AF%E8%BF%BD%E8%B8%AA"><span class="toc-number">1.10.1.</span> <span class="toc-text">链路追踪</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7-amp-%E6%8A%A5%E8%AD%A6"><span class="toc-number">1.10.2.</span> <span class="toc-text">性能监控&amp;报警</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A5%E5%BF%97%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.10.3.</span> <span class="toc-text">日志服务</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#springcloud-%E9%99%90%E6%B5%81%E8%AE%BE%E7%BD%AE%E5%85%B7%E4%BD%93%E6%98%AF%E6%80%8E%E4%B9%88%E8%AE%BE%E7%BD%AE%E7%9A%84"><span class="toc-number">1.11.</span> <span class="toc-text">springcloud 限流设置具体是怎么设置的</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#java%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0hash%E8%A1%A8%E7%9A%84"><span class="toc-number">1.12.</span> <span class="toc-text">java如何实现hash表的</span></a></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">1.13.</span> <span class="toc-text"></span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%95%E9%93%BE%E8%A1%A8%E6%9C%89%E4%BB%80%E4%B9%88%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="toc-number">1.14.</span> <span class="toc-text">单链表有什么优缺点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%A8%E8%BF%87%E5%8E%BB%E7%9A%84%E9%A1%B9%E7%9B%AE%E4%B8%AD%EF%BC%8C%E6%98%AF%E5%90%A6%E6%9C%89%E9%80%9A%E8%BF%87%E7%8A%B6%E6%80%81%E6%9C%BA%E5%8E%BB%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%BA%9B%E5%8A%9F%E8%83%BD"><span class="toc-number">1.15.</span> <span class="toc-text">在过去的项目中，是否有通过状态机去实现一些功能</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%86%94%E6%96%AD%E6%9C%BA%E5%88%B6"><span class="toc-number">1.15.1.</span> <span class="toc-text">熔断机制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%84%E5%88%99%E5%BC%95%E6%93%8E"><span class="toc-number">1.15.2.</span> <span class="toc-text">规则引擎</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BE%AE%E6%9C%8D%E5%8A%A1%E7%9A%84%E9%A1%B9%E7%9B%AE%E9%87%8C%E6%98%AF%E7%94%A8%E4%BB%80%E4%B9%88%E6%96%B9%E5%BC%8F%E5%AE%9E%E7%8E%B0%E9%99%90%E6%B5%81%E5%92%8C%E7%86%94%E6%96%AD%E9%99%8D%E7%BA%A7%E7%9A%84"><span class="toc-number">1.16.</span> <span class="toc-text">微服务的项目里是用什么方式实现限流和熔断降级的?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E9%99%90%E6%B5%81"><span class="toc-number">1.16.1.</span> <span class="toc-text">为什么要限流</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%89%E5%87%A0%E7%A7%8D%E9%99%90%E6%B5%81%E6%96%B9%E5%BC%8F"><span class="toc-number">1.16.2.</span> <span class="toc-text">有几种限流方式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%89%E8%AF%B7%E6%B1%82IP%E9%99%90%E6%B5%81"><span class="toc-number">1.16.2.1.</span> <span class="toc-text">按请求IP限流</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%89%E8%AF%B7%E6%B1%82%E5%9C%B0%E5%9D%80%E9%99%90%E6%B5%81"><span class="toc-number">1.16.2.2.</span> <span class="toc-text">按请求地址限流</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%99%90%E6%B5%81%E7%AE%97%E6%B3%95"><span class="toc-number">1.16.3.</span> <span class="toc-text">限流算法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%A4%E7%89%8C%E6%A1%B6%E7%AE%97%E6%B3%95"><span class="toc-number">1.16.3.1.</span> <span class="toc-text">令牌桶算法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BC%8F%E6%A1%B6%E7%AE%97%E6%B3%95"><span class="toc-number">1.16.3.2.</span> <span class="toc-text">漏桶算法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%89%E5%93%AA%E4%BA%9B%E5%AE%9E%E7%8E%B0%E6%A1%86%E6%9E%B6"><span class="toc-number">1.16.4.</span> <span class="toc-text">有哪些实现框架</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#springcloud-zuul"><span class="toc-number">1.16.4.1.</span> <span class="toc-text">springcloud-zuul</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Hystixy"><span class="toc-number">1.16.4.2.</span> <span class="toc-text">Hystixy</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Sentinel"><span class="toc-number">1.16.4.3.</span> <span class="toc-text">Sentinel</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E9%99%8D%E7%BA%A7"><span class="toc-number">1.16.5.</span> <span class="toc-text">为什么要降级</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%99%8D%E7%BA%A7%E7%9A%84%E5%8E%9F%E7%90%86"><span class="toc-number">1.16.6.</span> <span class="toc-text">降级的原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%93%AA%E4%BA%9B%E6%A1%86%E6%9E%B6%E5%AE%9E%E7%8E%B0%E4%BA%86%E9%99%8D%E7%BA%A7"><span class="toc-number">1.16.7.</span> <span class="toc-text">哪些框架实现了降级</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Hystixy-1"><span class="toc-number">1.16.7.1.</span> <span class="toc-text">Hystixy</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Sentinel-1"><span class="toc-number">1.16.7.2.</span> <span class="toc-text">Sentinel</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E6%8E%A5%E5%8F%A3%E7%9A%84%E5%B9%82%E7%AD%89%E6%80%A7"><span class="toc-number">1.17.</span> <span class="toc-text">如何实现接口的幂等性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B9%90%E8%A7%82%E9%94%81"><span class="toc-number">1.17.1.</span> <span class="toc-text">数据库乐观锁</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E5%94%AF%E4%B8%80%E9%94%AEID%E7%BA%A6%E6%9D%9F"><span class="toc-number">1.17.2.</span> <span class="toc-text">全局唯一键ID约束</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%B2%E9%87%8DToken%E4%BB%A4%E7%89%8C"><span class="toc-number">1.17.3.</span> <span class="toc-text">防重Token令牌</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%A0%E9%80%92%E8%AF%B7%E6%B1%82ID-%E8%AE%A4%E8%AF%81key"><span class="toc-number">1.17.4.</span> <span class="toc-text">传递请求ID+认证key</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9C%89%E5%87%A0%E7%A7%8D%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E"><span class="toc-number">1.18.</span> <span class="toc-text">mysql数据库有几种存储引擎</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#innerDB"><span class="toc-number">1.18.1.</span> <span class="toc-text">innerDB</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MyiSam"><span class="toc-number">1.18.2.</span> <span class="toc-text">MyiSam</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E6%B0%B4%E5%B9%B3%E6%96%B9%E5%90%91%E7%9A%84%E6%89%A9%E5%B1%95"><span class="toc-number">1.19.</span> <span class="toc-text">mysql数据库水平方向的扩展</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9E%82%E7%9B%B4-%E7%BA%B5%E5%90%91-%E6%8B%86%E5%88%86%EF%BC%9A"><span class="toc-number">1.19.1.</span> <span class="toc-text">垂直(纵向)拆分：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B0%B4%E5%B9%B3-%E6%A8%AA%E5%90%91-%E6%8B%86%E5%88%86%EF%BC%9A"><span class="toc-number">1.19.2.</span> <span class="toc-text">水平(横向)拆分：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E5%88%86%E5%8C%BA%EF%BC%8C%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E5%88%86%E5%BA%93%EF%BC%8C%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E5%88%86%E8%A1%A8"><span class="toc-number">1.20.</span> <span class="toc-text">数据库什么时候分区，什么时候分库，什么时候分表</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E5%8C%BA"><span class="toc-number">1.20.1.</span> <span class="toc-text">分区</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sharding-%E5%88%86%E7%89%87"><span class="toc-number">1.20.2.</span> <span class="toc-text">sharding(分片)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E5%BA%93"><span class="toc-number">1.20.3.</span> <span class="toc-text">分库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E8%A1%A8"><span class="toc-number">1.20.4.</span> <span class="toc-text">分表</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8F%92%E5%85%A5%E4%B8%80%E6%9D%A1%E6%95%B0%E6%8D%AE%EF%BC%8C%E5%85%B7%E4%BD%93%E5%81%9A%E4%BA%86%E4%BB%80%E4%B9%88%E4%BA%8B%E6%83%85"><span class="toc-number">1.21.</span> <span class="toc-text">mysql数据库插入一条数据，具体做了什么事情</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mysql%E7%9A%84ACID%E6%98%AF%E6%80%8E%E4%B9%88%E5%AE%9E%E7%8E%B0%E7%9A%84"><span class="toc-number">1.22.</span> <span class="toc-text">mysql的ACID是怎么实现的</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E5%AD%90%E6%80%A7"><span class="toc-number">1.22.1.</span> <span class="toc-text">原子性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E8%87%B4%E6%80%A7"><span class="toc-number">1.22.2.</span> <span class="toc-text">一致性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9A%94%E7%A6%BB%E6%80%A7"><span class="toc-number">1.22.3.</span> <span class="toc-text">隔离性</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%84%8F%E8%AF%BB"><span class="toc-number">1.22.3.1.</span> <span class="toc-text">脏读</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8D%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB"><span class="toc-number">1.22.3.2.</span> <span class="toc-text">不可重复读</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B9%BB%E8%AF%BB"><span class="toc-number">1.22.3.3.</span> <span class="toc-text">幻读</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%81%E4%B9%85%E6%80%A7"><span class="toc-number">1.22.4.</span> <span class="toc-text">持久性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mysql%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E6%96%B9%E5%BC%8F"><span class="toc-number">1.23.</span> <span class="toc-text">mysql集群部署方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL-Replication-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6"><span class="toc-number">1.23.1.</span> <span class="toc-text">MySQL Replication(主从复制)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL-Fabirc"><span class="toc-number">1.23.2.</span> <span class="toc-text">MySQL Fabirc</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL-Cluster"><span class="toc-number">1.23.3.</span> <span class="toc-text">MySQL Cluster</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Zookeeper-proxy"><span class="toc-number">1.23.4.</span> <span class="toc-text">Zookeeper + proxy</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Paxos"><span class="toc-number">1.23.5.</span> <span class="toc-text">Paxos</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E9%98%B2%E6%AD%A2redis%E9%9B%AA%E5%B4%A9%EF%BC%8C%E7%A9%BF%E9%80%8F%EF%BC%8C%E5%87%BB%E7%A9%BF"><span class="toc-number">1.24.</span> <span class="toc-text">如何防止redis雪崩，穿透，击穿</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%AA%E5%B4%A9"><span class="toc-number">1.24.1.</span> <span class="toc-text">雪崩</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A9%BF%E9%80%8F"><span class="toc-number">1.24.2.</span> <span class="toc-text">穿透</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BB%E7%A9%BF"><span class="toc-number">1.24.3.</span> <span class="toc-text">击穿</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#redis%E6%9C%89%E5%87%A0%E7%A7%8D%E5%AD%98%E5%82%A8%E6%96%B9%E5%BC%8F"><span class="toc-number">1.25.</span> <span class="toc-text">redis有几种存储方式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#linux%E7%B3%BB%E7%BB%9F%E9%9B%B6%E6%8B%B7%E8%B4%9D"><span class="toc-number">1.26.</span> <span class="toc-text">linux系统零拷贝</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%A4%E4%B8%AA%E4%B8%8D%E5%90%8C%E7%9A%84%E7%BD%91%E7%AB%99%EF%BC%8C%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%99%BB%E9%99%86%E7%8A%B6%E6%80%81%E5%90%8C%E6%AD%A5"><span class="toc-number">1.27.</span> <span class="toc-text">两个不同的网站，如何实现登陆状态同步</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#java8%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B%E7%94%A8%E8%BF%87%E5%93%AA%E4%BA%9B%EF%BC%8C%E4%B8%BE%E4%BE%8B%E8%AF%B4%E6%98%8E"><span class="toc-number">1.28.</span> <span class="toc-text">java8函数式编程用过哪些，举例说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E4%B8%8E%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86"><span class="toc-number">1.29.</span> <span class="toc-text">对称加密与非对称加密</span></a></li></ol></li></ol>
		
		</div>
		
		<h1 id="2022年2月interView"><a title="2022年2月interView" class="headerlink" href="#2022年2月interView"></a>2022年2月interView</h1><p>做总结，复习，学习。。。。。。</p>
<blockquote>
<p>java所有问题基于jdk1.8</p>
</blockquote>
<h2 id="jvm的两种回收机制，cms和g1的工作原理及区别"><a title="jvm的两种回收机制，cms和g1的工作原理及区别" class="headerlink" href="#jvm的两种回收机制，cms和g1的工作原理及区别"></a>jvm的两种回收机制，cms和g1的工作原理及区别</h2><blockquote>
<p>cms</p>
</blockquote>
<p>暂停性内存回收，采用标记–清除算法, 块状清理，容易产生更多碎片。</p>
<p>gc运行时将使所有线程挂起，导致系统服务出现短暂停止。</p>
<blockquote>
<p>g1</p>
</blockquote>
<p>jdk1.7推出，采用并行、并发标记整理算法，可预测停顿，产生更少的碎片, 以网格方式进行gc分析处理。</p>
<h2 id="JVM运行中新生代对象在什么情况下，会被上升到老年代？"><a title="JVM运行中新生代对象在什么情况下，会被上升到老年代？" class="headerlink" href="#JVM运行中新生代对象在什么情况下，会被上升到老年代？"></a>JVM运行中新生代对象在什么情况下，会被上升到老年代？</h2><p>答：未被使用的时候，如果没有引用了，对象会被直接回收，引发ygc。</p>
<h3 id="怎么判断对象可回收"><a title="怎么判断对象可回收" class="headerlink" href="#怎么判断对象可回收"></a>怎么判断对象可回收</h3><p>需要进行一系列的可达性分析：</p>
<ol>
<li><p>查找无GC Root引用后，jvm将对其作一次mark</p>
</li>
<li><p>jvm不期对已标记对象进行筛选，根据情况再决定是否调用finalize方法</p>
</li>
<li><p>如果对象被判定需要执行finalize方法，则将此对象移入F-Queue队列中,等待 Finalizer 线程执行</p>
</li>
<li><p>执行finalize方法中，GC将对F-Queue中对象进行二次标记，用来判定是否触发gc</p>
</li>
</ol>
<blockquote>
<p> 通过一系列的 ‘GC Roots’ 的对象作为起始点，从这些节点出发所走过的路径称为引用链。当一个对象到 GC Roots 没有任何引用链相连的时候说明对象可回收，没有被使用。</p>
</blockquote>
<p>可作为 GC Roots 的对象：</p>
<ul>
<li>虚拟机栈(栈帧中的本地变量表)中引用的对象</li>
<li>方法区中类静态属性引用的对象</li>
<li>方法区中常量引用的对象</li>
<li>本地方法栈中 JNI(即一般说的 Native 方法) 引用的对象</li>
</ul>
<h3 id="堆中有对象可回收时，触发的哪种机制回收"><a title="堆中有对象可回收时，触发的哪种机制回收" class="headerlink" href="#堆中有对象可回收时，触发的哪种机制回收"></a>堆中有对象可回收时，触发的哪种机制回收</h3><h4 id="gc时采用的算法"><a title="gc时采用的算法" class="headerlink" href="#gc时采用的算法"></a>gc时采用的算法</h4><ul>
<li>标记–清除算法</li>
<li>标记- 整理算法</li>
</ul>
<p>老年代gc时采用的算法</p>
<ul>
<li>复制算法</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41701956/article/details/81664921">JVM hotspot</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/358607300">垃圾收集器</a></p>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1338426">java8 jvm的变化</a></p>
<h2 id="JVM是如何与cpu、内存进行调度交互的"><a title="JVM是如何与cpu、内存进行调度交互的?" class="headerlink" href="#JVM是如何与cpu、内存进行调度交互的"></a>JVM是如何与cpu、内存进行调度交互的?</h2><p>jvm相关文章参考：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41701956/article/details/81664921">https://blog.csdn.net/qq_41701956/article/details/81664921</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/yichunguo/p/12007038.html">https://www.cnblogs.com/yichunguo/p/12007038.html</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/smartbetter/article/details/80561284">https://blog.csdn.net/smartbetter/article/details/80561284</a></p>
<p><a target="_blank" rel="noopener" href="https://developer.aliyun.com/article/368436">https://developer.aliyun.com/article/368436</a></p>
<h2 id="有个秒杀接口，接口中间调用了几个微服务接口，原来支持1000个QPS-现在要求优化，将QPS提升到1万-，怎么优化"><a title="有个秒杀接口，接口中间调用了几个微服务接口，原来支持1000个QPS, 现在要求优化，将QPS提升到1万+，怎么优化?" class="headerlink" href="#有个秒杀接口，接口中间调用了几个微服务接口，原来支持1000个QPS-现在要求优化，将QPS提升到1万-，怎么优化"></a>有个秒杀接口，接口中间调用了几个微服务接口，原来支持1000个QPS, 现在要求优化，将QPS提升到1万+，怎么优化?</h2><p>异步队列？</p>
<p>生产者消费者？</p>
<p>确保最终一致性？事后补偿机制</p>
<h2 id="工作中有解决过什么问题，解决思路是什么"><a title="工作中有解决过什么问题，解决思路是什么?" class="headerlink" href="#工作中有解决过什么问题，解决思路是什么"></a>工作中有解决过什么问题，解决思路是什么?</h2><h3 id="应用重启问题"><a title="应用重启问题" class="headerlink" href="#应用重启问题"></a>应用重启问题</h3><blockquote>
<p>影响因素：</p>
<ol>
<li><p>内存分配不合理，堆内存溢出导致crash</p>
</li>
<li><p>线程池使用不当，核心线程数设置太高，导致大量线程请求连接堵塞，占用内存与io, 最大线程数2n+3</p>
</li>
</ol>
</blockquote>
<p>问题分析：</p>
<p>以每秒打印一次gc情况：</p>
<p>​		<code>jstat -gcutil 12 1000</code></p>
<p>发现ygc特别频繁，平均2分钟一次，一小时几乎30次,一天720次，而fullgc一天平均16次。</p>
<ol>
<li>由于fullgc的效率远没有ygc高，所以肯定是因为内存分配不合理，导致fullgc频繁，而ygc的次数特别高，说明在年轻代的对象生产特别快，导致年轻代需要通过频繁的gc来释放更多的空间以便容纳新对象。而老年代gc频繁，说明有越来越多的长期未释放的对象或线程占用资源，需要移动到老年代，而老年代由于空间不足，只能通过不断gc来释放，但由于fullgc太过频繁，而由于又是使用的CMS作为收集方式，系统将暂停，所有线程将会被挂起，而随着时间推移，系统暂停时间越来越长，导致k8s健康检查失败，从而导致触发重启。</li>
<li>通过观察，应用中活动线程数超过了3000个，而默认一个线程栈大小是1M，如果这3000个线程一直不回收，或者nio发生堵塞，则就会OOM, 而出现这种情况的原因是线程池参数配置有问题(<code>N = int availableProcessors = Runtime.getRuntime().availableProcessors();</code>docker容器不能使用这种写法, 取到的是宿主机的cpu线程数)</li>
</ol>
<p>解决方案：</p>
<p>容器内存8G</p>
<ol>
<li>调整jvm堆内存大小，将堆内存设置为5G(NewSize设置为3G，剩下的就是OldSize为2G), 还剩3G给非堆动态扩展(元空间默认大小21M, 其余将近3G内存由非堆支配)</li>
<li>设置线程池参数，将核心线程数设置为2+1，最大活跃线程数控制在2*2+1，blockQueue管道大小设置为100(经验参数)，将系统线程数控制在105个左右，减少非堆的内存压力。</li>
<li>将jvm参数中的线程栈大小设置为512kb, 减少线程stack内存占用，提高线程池容量。</li>
</ol>
<h3 id="包冲突导致应用访问异常问题"><a title="包冲突导致应用访问异常问题" class="headerlink" href="#包冲突导致应用访问异常问题"></a>包冲突导致应用访问异常问题</h3><blockquote>
<p>现象:</p>
<ol>
<li>应用可以正常启动</li>
<li>业务接口通过postman可正常返回</li>
<li>curl 命令访问接口返回的http状态码为500，但有返回值</li>
</ol>
</blockquote>
<p>原因：</p>
<p>项目里有大量包冲突，其中hibenate的Validator包影响了springboot web中相关的包。</p>
<p>解决方式：</p>
<ol>
<li>解决包冲突</li>
<li>删除hibernate相关包（用不到）</li>
</ol>
<h2 id="配置中心技术选型，各配置中心的区别与优缺点，为什么最终选择了那个"><a title="配置中心技术选型，各配置中心的区别与优缺点，为什么最终选择了那个?" class="headerlink" href="#配置中心技术选型，各配置中心的区别与优缺点，为什么最终选择了那个"></a>配置中心技术选型，各配置中心的区别与优缺点，为什么最终选择了那个?</h2><h3 id="nacos"><a title="nacos" class="headerlink" href="#nacos"></a>nacos</h3><h3 id="apollo"><a title="apollo" class="headerlink" href="#apollo"></a>apollo</h3><h3 id="discover-server"><a title="discover server" class="headerlink" href="#discover-server"></a>discover server</h3><h2 id="有两个List-每个list都有100w条数据，现在要将两个list中的重复数据取出来，有什么办法-也可以借助第三方中间件实现-？"><a title="有两个List,每个list都有100w条数据，现在要将两个list中的重复数据取出来，有什么办法(也可以借助第三方中间件实现)？" class="headerlink" href="#有两个List-每个list都有100w条数据，现在要将两个list中的重复数据取出来，有什么办法-也可以借助第三方中间件实现-？"></a>有两个List,每个list都有100w条数据，现在要将两个list中的重复数据取出来，有什么办法(也可以借助第三方中间件实现)？</h2><p>一个map，将重复数据取出</p>
<ol>
<li>将list以k,v存入map</li>
<li>将第二个list遍历，将值作为key去取，取到值则将其放入到新list中</li>
</ol>
<h2 id="rabbiMQ-配置问题"><a title="rabbiMQ 配置问题" class="headerlink" href="#rabbiMQ-配置问题"></a>rabbiMQ 配置问题</h2><h3 id="服务端配置"><a title="服务端配置" class="headerlink" href="#服务端配置"></a>服务端配置</h3><blockquote>
<p>num_acceptors.tcp tcp 接受TCP侦听器连接的Erlang进程数。</p>
</blockquote>
<p>一旦打开了一个使用tcp连接的套接字，它就始终保持打开状态，直至任何一方关闭它或因为一个错误而终止。在建立一个连接时，一般为每一次请求产生一个新进程，num_acceptors就是控制产生新进程的个数。假设有一个监听进程，其任务是等待传入的tcp请求。只要一个请求到达，响应该连接请求的进程就变成了接收进程。默认的配置为num_acceptors.tcp = 10。</p>
<pre><code class="shell">num_acceptors.tcp = 10
</code></pre>
<blockquote>
<p>handshake_timeout  </p>
<p>Maximum time for AMQP 0-9-1 handshake (after socket connection and TLS handshake), in milliseconds.</p>
</blockquote>
<p>AMQP 0-9-1握手（socket连接和TLS握手之后）的最大时间，以毫秒为单位。<br>默认的配置为handshake_timeout = 10000。</p>
<pre><code class="shell">handshake_timeout = 10000
</code></pre>
<blockquote>
<p>channel_max</p>
<p>Maximum permissible number of channels to negotiate with clients, not including a special channel number 0 used in the protocol. Setting to 0 means “unlimited”, a dangerous value since applications sometimes have channel leaks. Using more channels increases memory footprint of the broker.</p>
</blockquote>
<p>设置每个连接的最大允许通道数量。 0表示“没有限制”。默认的配置为channel_max = 2047。</p>
<pre><code class="shell">channel_max = 2047
</code></pre>
<blockquote>
<p>max_message_size</p>
<p>The largest allowed message payload size in bytes. Messages of larger size will be rejected with a suitable channel exception</p>
</blockquote>
<p>最大消息大小设置，超过了会抛出相应的通道异常来拒绝消息。</p>
<p>默认值：134217728 byte， 最大值: 536870912 byte</p>
<h4 id="集群相关配置"><a title="集群相关配置" class="headerlink" href="#集群相关配置"></a>集群相关配置</h4><h5 id="cluster-partition-handling"><a title="cluster_partition_handling" class="headerlink" href="#cluster-partition-handling"></a>cluster_partition_handling</h5><blockquote>
<p>cluster_partition_handling</p>
<p>How to handle network partitions? </p>
</blockquote>
<p>network partitions 就是脑裂，网络分裂,也叫 <code>脑裂（split-brain）</code></p>
<h6 id="如何处理rabbitMQ集群脑裂问题"><a title="如何处理rabbitMQ集群脑裂问题" class="headerlink" href="#如何处理rabbitMQ集群脑裂问题"></a>如何处理rabbitMQ集群脑裂问题</h6><p>一种在系统的任何两个集群之间的所有网络连接同时发生故障后所出现的情况。发生这种情况时，分裂的系统双方都会从对方一侧重新启动应用程序，进而导致重复服务或裂脑。由网络分裂造成的最为严重的问题是它会影响共享磁盘上的数据。默认为ignore模式。如何处理网络分裂？详细的文档可以参考<a target="_blank" rel="noopener" href="https://www.rabbitmq.com/partitions.html#automatic-handling">官网文档</a></p>
<p>rabbitMQ提供了四种处理模式可选:</p>
<ul>
<li><p>ignore：忽略不处理</p>
</li>
<li><p>pause_minority：暂停少数模式。</p>
<p>RabbitMQ在看到其他节点停止后自动处于少数（即少于或等于节点总数的一半）的群集节点。 因此，它从CAP定理中选择对可用性的分裂容差。 这确保了在网络分裂的情况下，单个分裂中的节点最多的将继续运行。 只要分裂开始，少数的节点就会暂停，并在分裂结束时再次启动。</p>
</li>
<li><p>autoheal：自动裁决。</p>
<p>如果分裂被认为已经发生，RabbitMQ将自动决定获胜分裂，并且将重新启动不在获胜分裂中的所有节点。 与pause_minority模式不同，它在分裂结束时生效，而不是在启动时生效。</p>
</li>
<li><p>pause_if_all_down：暂停全部关闭模式。</p>
<p>所有列出的节点都必须关闭以便RabbitMQ暂停群集节点。这接近暂停少数模式，但是，它允许管理员决定选择哪个节点，而不是依赖于上下文。例如，如果集群由机架A中的两个节点和机架B中的两个节点组成，并且机架之间的链路丢失，则暂停少数模式将暂停所有节点。如果管理员在机架A中列出了两个节点，那么在全部停机模式下，只有机架B中的节点才会暂停。请注意，列出的节点可能会在分区的两侧分裂：在这种情况下，没有节点会暂停。这就是为什么有一个额外的ignore / autoheal参数来指示如何从分区中恢复。</p>
</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://juejin.cn/post/6844903895387340813">参考文章1</a></p>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1027323">参考文章2</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/b7cc32b94d2a">集群方式</a></p>
<h5 id="mirroring-sync-batch-size"><a title="mirroring_sync_batch_size" class="headerlink" href="#mirroring-sync-batch-size"></a>mirroring_sync_batch_size</h5><p>在消息中镜像同步批量大小。增加这将加快同步，但批量总大小（以字节为单位）不得超过2 GiB。该设置可用于RabbitMQ 3.6.0或更高版本。默认的配置为 mirroring_sync_batch_size = 4096(4k)。</p>
<p>default:</p>
<pre><code class="shell">mirroring_sync_batch_size = 4096
</code></pre>
<h5 id="rabbitMQ集群发现机制"><a title="rabbitMQ集群发现机制" class="headerlink" href="#rabbitMQ集群发现机制"></a>rabbitMQ集群发现机制</h5><ul>
<li>Config file</li>
<li>DNS</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/guchunchao/p/13176206.html#_label0">另rabbitMQ各集群模式实现</a></p>
<p><a target="_blank" rel="noopener" href="https://developer.aliyun.com/article/606985">10个节点的集群搭建</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/doit8791/p/10295262.html#:~:text=RabbitMQ%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%AE%97%E6%B3%95.%20%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%EF%BC%88Load%20balance%EF%BC%89%E6%98%AF%E4%B8%80%E7%A7%8D%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF%EF%BC%8C%E7%94%A8%E4%BA%8E%E5%9C%A8%E5%A4%9A%E4%B8%AA%E8%AE%A1%E7%AE%97%E6%9C%BA%EF%BC%88%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%9B%86%E7%BE%A4%EF%BC%89%E3%80%81%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5%E3%80%81CPU%E3%80%81%E7%A3%81%E7%9B%98%E9%A9%B1%E5%8A%A8%E5%99%A8%E6%88%96%E5%85%B6%E4%BB%96%E8%B5%84%E6%BA%90%E4%B8%AD%E5%88%86%E9%85%8D%E8%B4%9F%E8%BD%BD%EF%BC%8C%E4%BB%A5%E8%BE%BE%E5%88%B0%E6%9C%80%E4%BD%B3%E8%B5%84%E6%BA%90%E4%BD%BF%E7%94%A8%E3%80%81%E6%9C%80%E5%A4%A7%E5%8C%96%E5%90%9E%E5%90%90%E7%8E%87%E3%80%81%E6%9C%80%E5%B0%8F%E5%93%8D%E5%BA%94%E6%97%B6%E9%97%B4%E4%BB%A5%E5%8F%8A%E9%81%BF%E5%85%8D%E8%BF%87%E8%BD%BD%E7%9A%84%E7%9B%AE%E7%9A%84%E3%80%82.,%E4%BD%BF%E7%94%A8%E5%B8%A6%E6%9C%89%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%9A%84%E5%A4%9A%E4%B8%AA%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BB%84%E4%BB%B6%EF%BC%8C%E5%8F%96%E4%BB%A3%E5%8D%95%E4%B8%80%E7%9A%84%E7%BB%84%E4%BB%B6%EF%BC%8C%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87%E5%86%97%E4%BD%99%E6%8F%90%E9%AB%98%E5%8F%AF%E9%9D%A0%E6%80%A7%E3%80%82.%20%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E9%80%9A%E5%B8%B8%E5%88%86%E4%B8%BA%E8%BD%AF%E4%BB%B6%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E5%92%8C%E7%A1%AC%E4%BB%B6%20">负载均衡的几种方式</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/guchunchao/p/13176206.html#_label0">https://www.cnblogs.com/guchunchao/p/13176206.html#_label0</a></p>
<h3 id="客户端配置"><a title="客户端配置" class="headerlink" href="#客户端配置"></a>客户端配置</h3><blockquote>
<p>prefetchCount参数的作用</p>
</blockquote>
<p>预加载，消费者消费之前将待消费消息放到本地block队列中，消费者消费完后直接从block中取下一消息f进行消费。</p>
<blockquote>
<p>有哪些size配置，分别是做什么的</p>
</blockquote>
<p><em><strong>setTxSize</strong></em>：设置事务当中可以处理的消息数量。</p>
<h2 id="rabbitMQ-怎么保证100-消息不丢失"><a title="rabbitMQ 怎么保证100%消息不丢失?" class="headerlink" href="#rabbitMQ-怎么保证100-消息不丢失"></a>rabbitMQ 怎么保证100%消息不丢失?</h2><ul>
<li>HA</li>
<li>集群(镜像模式)</li>
<li>异地多活(federation插件)</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/w15802080081/article/details/121858744">镜像模式</a></p>
<p><a target="_blank" rel="noopener" href="https://developer.aliyun.com/article/606985#slide-1">参考文章1</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/guchunchao/p/13176206.html#_label0">参考文章2</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/ZhuChangwu/p/14093107.html#%E4%BB%80%E4%B9%88%E6%98%AFamqp-%E5%92%8C-jms">参考文章3</a></p>
<p><a target="_blank" rel="noopener" href="https://www.rabbitmq.com/configure.html">官方文档</a></p>
<h2 id="你们微服务系统主要使用了哪些监控系统"><a title="你们微服务系统主要使用了哪些监控系统" class="headerlink" href="#你们微服务系统主要使用了哪些监控系统"></a>你们微服务系统主要使用了哪些监控系统</h2><h3 id="链路追踪"><a title="链路追踪" class="headerlink" href="#链路追踪"></a>链路追踪</h3><blockquote>
<p>skywalking</p>
</blockquote>
<p>优点：</p>
<ol>
<li>代码无侵入</li>
<li>有dashboard</li>
<li>apache 开源</li>
</ol>
<blockquote>
<p>Spring Cloud Sleuth + zipkin</p>
</blockquote>
<p>查看微服务调用关系，非常清晰</p>
<ol>
<li>twitter 开源</li>
<li>代码侵入</li>
<li>链路更清晰</li>
</ol>
<p>、</p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/298230176">参考文章</a></p>
<h3 id="性能监控-amp-报警"><a title="性能监控&amp;报警" class="headerlink" href="#性能监控-amp-报警"></a>性能监控&amp;报警</h3><blockquote>
<p>Prometheus+Grafana</p>
</blockquote>
<h3 id="日志服务"><a title="日志服务" class="headerlink" href="#日志服务"></a>日志服务</h3><p>elk</p>
<p>链路</p>
<h2 id="springcloud-限流设置具体是怎么设置的"><a title="springcloud 限流设置具体是怎么设置的" class="headerlink" href="#springcloud-限流设置具体是怎么设置的"></a>springcloud 限流设置具体是怎么设置的</h2><blockquote>
<p>至少说出类名</p>
</blockquote>
<p>实现 HystrixCommand父类</p>
<p><a target="_blank" rel="noopener" href="https://api.cloud.yisu.com/zixun/88871.html">https://api.cloud.yisu.com/zixun/88871.html</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/varyall/article/details/99722594">https://blog.csdn.net/varyall/article/details/99722594</a></p>
<h2 id="java如何实现hash表的"><a title="java如何实现hash表的" class="headerlink" href="#java如何实现hash表的"></a>java如何实现hash表的</h2><p>hashTable</p>
<h2 id=""><a title="" class="headerlink" href="#"></a></h2><h2 id="单链表有什么优缺点"><a title="单链表有什么优缺点" class="headerlink" href="#单链表有什么优缺点"></a>单链表有什么优缺点</h2><p>优：查找指点节点速度快，插入与删除不需要移动下标，所以插入删除也快</p>
<p>缺：</p>
<ol>
<li>链表需要占用更多的内存，因为链表中的每个节点都包含一个指针引用，会一直占用内存</li>
<li>在链表中很难遍历元素或节点。 我们不能像按索引在数组中那样随机访问任何元素，如果我们要访问位置n处的节点，则必须遍历它之前的所有节点。 因此，访问节点所需的时间很大</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/culing2941/article/details/108649963">https://blog.csdn.net/culing2941/article/details/108649963</a></p>
<h2 id="在过去的项目中，是否有通过状态机去实现一些功能"><a title="在过去的项目中，是否有通过状态机去实现一些功能" class="headerlink" href="#在过去的项目中，是否有通过状态机去实现一些功能"></a>在过去的项目中，是否有通过状态机去实现一些功能</h2><h3 id="熔断机制"><a title="熔断机制" class="headerlink" href="#熔断机制"></a>熔断机制</h3><h3 id="规则引擎"><a title="规则引擎" class="headerlink" href="#规则引擎"></a>规则引擎</h3><h2 id="微服务的项目里是用什么方式实现限流和熔断降级的"><a title="微服务的项目里是用什么方式实现限流和熔断降级的?" class="headerlink" href="#微服务的项目里是用什么方式实现限流和熔断降级的"></a>微服务的项目里是用什么方式实现限流和熔断降级的?</h2><h3 id="为什么要限流"><a title="为什么要限流" class="headerlink" href="#为什么要限流"></a>为什么要限流</h3><p>突发大并发量请求流入进来，可能将导致系统崩溃，无法响应。</p>
<p>限流的目的就是形成一种保护机制，让系统的入口流量和系统的负载达到一个平衡，保证系统在能力范围之内处理最多的请求。</p>
<h3 id="有几种限流方式"><a title="有几种限流方式" class="headerlink" href="#有几种限流方式"></a>有几种限流方式</h3><h4 id="按请求IP限流"><a title="按请求IP限流" class="headerlink" href="#按请求IP限流"></a>按请求IP限流</h4><p>springcloud gateway + RedisRateLimter实现</p>
<p>网关引入的redis-reactive，背压模式的redis：</p>
<pre><code class="xml">&lt;!--基于 reactive stream 的redis --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-data-redis-reactive&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
<p>配置gateway针对某一服务的限流配置文件：</p>
<pre><code class="yaml">spring:
  cloud:
    gateway:
      routes:
      - id: requestratelimiter_route
        uri: lb://upms
        order: 10000
        predicates:
        - Path=/admin/**
        filters:
        - name: RequestRateLimiter
          args:
            redis-rate-limiter.replenishRate: 1  # 令牌桶的容积
            redis-rate-limiter.burstCapacity: 3  # 流速 每秒
            key-resolver: "#&#123;@remoteAddrKeyResolver&#125;" #SPEL表达式去的对应的bean
        - StripPrefix=1
</code></pre>
<p>ps: 配置的<code>RequestRateLimiter</code>过滤器指的就是<code>RequestRateLimiterGatewayFilterFactory.java</code> </p>
<p><a target="_blank" rel="noopener" href="https://cloud.spring.io/spring-cloud-gateway/reference/html/#the-redis-ratelimiter">官方文档</a></p>
<p>配置bean，多维度限流量的入口 对应上边key-resolver</p>
<p>​	</p>
<pre><code class="java">/**

* 自定义限流标志的key，多个维度可以从这里入手
* exchange对象中获取服务ID、请求信息，用户信息等
  */
  @Bean
  KeyResolver remoteAddrKeyResolver() &#123;
    return exchange -&gt; Mono.just(exchange.getRequest().getRemoteAddress().getHostName());
  &#125;
</code></pre>
<p>Spring Cloud Gateway 默认实现 Redis限流，如果扩展只需要实现ratelimter接口即可。</p>
<p><img loading="lazy" alt="img" src="/images/e6c9d24ely1h04204eo2vj20yk0k0jrz.png"></p>
<p><a target="_blank" rel="noopener" href="https://cloud.spring.io/spring-cloud-gateway/reference/html/#the-redis-ratelimiter">官方文档</a></p>
<p><a target="_blank" rel="noopener" href="https://www.yuque.com/pig4cloud/pig/oeyy8h">参考文章</a></p>
<h4 id="按请求地址限流"><a title="按请求地址限流" class="headerlink" href="#按请求地址限流"></a>按请求地址限流</h4><p>同ip限流类似</p>
<h3 id="限流算法"><a title="限流算法" class="headerlink" href="#限流算法"></a>限流算法</h3><h4 id="令牌桶算法"><a title="令牌桶算法" class="headerlink" href="#令牌桶算法"></a>令牌桶算法</h4><ul>
<li><p>固定窗口算法</p>
</li>
<li><p>滑动窗口算法</p>
</li>
</ul>
<h4 id="漏桶算法"><a title="漏桶算法" class="headerlink" href="#漏桶算法"></a>漏桶算法</h4><h3 id="有哪些实现框架"><a title="有哪些实现框架" class="headerlink" href="#有哪些实现框架"></a>有哪些实现框架</h3><h4 id="springcloud-zuul"><a title="springcloud-zuul" class="headerlink" href="#springcloud-zuul"></a>springcloud-zuul</h4><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/smallfa/p/13929833.html">https://www.cnblogs.com/smallfa/p/13929833.html</a></p>
<h4 id="Hystixy"><a title="Hystixy" class="headerlink" href="#Hystixy"></a>Hystixy</h4><p><a target="_blank" rel="noopener" href="https://github.com/Netflix/Hystrix/wiki/How-To-Use#Synchronous-Execution">https://github.com/Netflix/Hystrix/wiki/How-To-Use#Synchronous-Execution</a></p>
<h4 id="Sentinel"><a title="Sentinel" class="headerlink" href="#Sentinel"></a>Sentinel</h4><blockquote>
<p>sentinel的限流规则是如何持久化的?</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://sentinelguard.io/zh-cn/docs/introduction.html">官方文档</a></p>
<p><a target="_blank" rel="noopener" href="https://juejin.cn/post/6844903758405566471">参考文章</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/92f8f8e33dd1">参考文章2</a></p>
<h3 id="为什么要降级"><a title="为什么要降级" class="headerlink" href="#为什么要降级"></a>为什么要降级</h3><p>微服务专家提出通过断路器模式来实现降级的规则。</p>
<h3 id="降级的原理"><a title="降级的原理" class="headerlink" href="#降级的原理"></a>降级的原理</h3><h3 id="哪些框架实现了降级"><a title="哪些框架实现了降级" class="headerlink" href="#哪些框架实现了降级"></a>哪些框架实现了降级</h3><h4 id="Hystixy-1"><a title="Hystixy" class="headerlink" href="#Hystixy-1"></a>Hystixy</h4><h4 id="Sentinel-1"><a title="Sentinel" class="headerlink" href="#Sentinel-1"></a>Sentinel</h4><p><a target="_blank" rel="noopener" href="https://api.cloud.yisu.com/zixun/625804.html">https://api.cloud.yisu.com/zixun/625804.html</a></p>
<h2 id="如何实现接口的幂等性"><a title="如何实现接口的幂等性" class="headerlink" href="#如何实现接口的幂等性"></a>如何实现接口的幂等性</h2><h3 id="数据库乐观锁"><a title="数据库乐观锁" class="headerlink" href="#数据库乐观锁"></a>数据库乐观锁</h3><p>添加版本号或者时间戳</p>
<h3 id="全局唯一键ID约束"><a title="全局唯一键ID约束" class="headerlink" href="#全局唯一键ID约束"></a>全局唯一键ID约束</h3><p>由数据库的唯一键约束来保证无重复数据产生</p>
<p>唯一ID需保证分布式环境中全局唯一</p>
<p>客户端—-&gt;请求分布式ID—-&gt;携带分布式ID请求业务接口—&gt;入库</p>
<p>如果有重复请求进来，则数据库唯一键约束会将此脏数据挡在外面。</p>
<h3 id="防重Token令牌"><a title="防重Token令牌" class="headerlink" href="#防重Token令牌"></a>防重Token令牌</h3><p>请求业务接口前从服务端拿一个token(此token唯一，存在redis中, key=token，value=userId)—–&gt;携带token访问新增接口—-&gt;服务端将token从redis中取出来，如果有值，且value与当前userId相匹配，则从redis中删除此token，并放行请求，否则就表示请求为重复请求或者非法请求。</p>
<h3 id="传递请求ID-认证key"><a title="传递请求ID+认证key" class="headerlink" href="#传递请求ID-认证key"></a>传递请求ID+认证key</h3><p>所谓<strong>请求ID</strong>，其实就是每次向服务端请求时候附带一个短时间内唯一不重复的序列号，该序列号可以是一个<strong>有序 <code>ID</code><strong>，也可以是一个</strong>订单号</strong>，一般由下游生成，在调用上游服务端接口时附加该序列号和用于认证的 <code>ID</code>。</p>
<p>当上游服务器收到请求信息后拿取该 <strong>请求ID</strong> 和下游 <strong>认证ID</strong> 进行组合，形成用于操作 Redis 的 <code>Key</code>，然后到 Redis 中查询是否存在对应的 <code>Key</code> 的键值对，根据其结果：</p>
<ol>
<li><strong>如果存在</strong>，就说明已经对该下游的该序列号的请求进行了业务处理，这时可以直接响应重复请求的错误信息。</li>
<li><strong>如果不存在</strong>，就以该 <code>Key</code> 作为 Redis 的键，以下游关键信息作为存储的值（例如下游商传递的一些业务逻辑信息），将该键值对存储到 Redis 中 ，然后再正常执行对应的业务逻辑即可。</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://juejin.cn/post/6906290538761158670">接口幂等性</a></p>
<h2 id="mysql数据库有几种存储引擎"><a title="mysql数据库有几种存储引擎" class="headerlink" href="#mysql数据库有几种存储引擎"></a>mysql数据库有几种存储引擎</h2><h3 id="innerDB"><a title="innerDB" class="headerlink" href="#innerDB"></a>innerDB</h3><ol>
<li>支持事务处理、ACID事务特性</li>
<li>实现了SQL标准的四种隔离级别</li>
<li>支持行级锁和外键约束</li>
<li>可以利用事务日志进行数据恢复</li>
<li>不支持FullText类型的索引，没有保存数据库行数，计算count(*)需要全局扫描</li>
<li>支持自动增加列属性auto_increment</li>
</ol>
<h3 id="MyiSam"><a title="MyiSam" class="headerlink" href="#MyiSam"></a>MyiSam</h3><ol>
<li>Mysql的默认引擎，其目标是快速读取。</li>
<li>快速读取，如果频繁插入和更新的话，因为涉及到数据全表锁，效率并不高</li>
<li>保存了数据库行数，执行count时，不需要扫描全表；</li>
<li>不支持数据库事务；</li>
<li>不支持行级锁和外键；</li>
<li>不支持故障恢复</li>
<li>支持全文检索FullText，压缩索引。</li>
</ol>
<p>其它引擎未使用过</p>
<h2 id="mysql数据库水平方向的扩展"><a title="mysql数据库水平方向的扩展" class="headerlink" href="#mysql数据库水平方向的扩展"></a>mysql数据库水平方向的扩展</h2><p>Mysql的扩展方案包括Scale Out和Scale Up两种。</p>
<p>Scale Out(横向扩展)是指Application可以在水平方向上扩展。一般对数据中心的应用而言，Scale out指的是当添加更多的机器时，应用仍然可以很好的利用这些机器的资源来提升自己的效率从而达到很好的扩展性。</p>
<p>Scale Up(纵向扩展)是指Application可以在垂直方向上扩展。一般对单台机器而言，Scale Up值得是当某个计算节点(机器)添加更多的CPU Cores，存储设备，使用更大的内存时，应用可以很充分的利用这些资源来提升自己的效率从而达到很好的扩展性。</p>
<p>MySql的Sharding策略包括垂直切分和水平切分两种。</p>
<h3 id="垂直-纵向-拆分："><a title="垂直(纵向)拆分：" class="headerlink" href="#垂直-纵向-拆分："></a>垂直(纵向)拆分：</h3><p>是指按功能模块拆分，以解决表与表之间的io竞争。比如分为订单库、商品库、用户库…这种方式多个数据库之间的表结构不同。</p>
<p>表结构设计垂直切分。常见的一些场景包括</p>
<p>a).大字段的垂直切分。单独将大字段建在另外的表中，提高基础表的访问性能，原则上在性能关键的应用中应当避免数据库的大字段</p>
<p>b). 按照使用用途垂直切分。例如企业物料属性，可以按照基本属性、销售属性、采购属性、生产制造属性、财务会计属性等用途垂直切分</p>
<p>c). 按照访问频率垂直切分。例如电子商务、Web 2.0系统中，如果用户属性设置非常多，可以将基本、使用频繁的属性和不常用的属性垂直切分开</p>
<h3 id="水平-横向-拆分："><a title="水平(横向)拆分：" class="headerlink" href="#水平-横向-拆分："></a>水平(横向)拆分：</h3><p>将同一个表的数据进行分块保存到不同的数据库中，来解决单表中数据量增长出现的压力。这些数据库中的表结构完全相同。</p>
<h2 id="数据库什么时候分区，什么时候分库，什么时候分表"><a title="数据库什么时候分区，什么时候分库，什么时候分表" class="headerlink" href="#数据库什么时候分区，什么时候分库，什么时候分表"></a>数据库什么时候分区，什么时候分库，什么时候分表</h2><h3 id="分区"><a title="分区" class="headerlink" href="#分区"></a>分区</h3><p>分区只不过把存放数据的文件分成了许多小块，分区后的表还是一张表，数据处理还是由自己来完成。</p>
<p>分区突破了磁盘I/O瓶颈，想提高磁盘的读写能力，来增加mysql性能。</p>
<p>分区实现是比较简单的，建立分区表，跟建平常的表没什么区别，并且对代码端来说是透明的。</p>
<h3 id="sharding-分片"><a title="sharding(分片)" class="headerlink" href="#sharding-分片"></a>sharding(分片)</h3><p>分片是把数据库横向扩展(Scale Out)到多个物理节点上的一种有效的方式，其主要目的是为突破单节点数据库服务器的 I/O 能力限制，解决数据库扩展性问题。Shard这个词的意思是“碎片”。如果将一个数据库当作一块大玻璃，将这块玻璃打碎，那么每一小块都称为数据库的碎片(DatabaseShard)。将整个数据库打碎的过程就叫做分片，可以翻译为分片。</p>
<p>形式上，分片可以简单定义为将大数据库分布到多个物理节点上的一个分区方案。</p>
<p>每一个分区包含数据库的某一部分，称为一个片，分区方式可以是任意的，并不局限于传统的水平分区和垂直分区。一个分片可以包含多个表的内容甚至可以包含多个数据库实例中的内容。每个分片被放置在一个数据库服务器上。一个数据库服务器可以处理一个或多个分片的数据。系统中需要有服务器进行查询路由转发，负责将查询转发到包含该查询所访问数据的分片或分片集合节点上去执行。</p>
<h3 id="分库"><a title="分库" class="headerlink" href="#分库"></a>分库</h3><p>把一个库拆成多个库，突破库级别的数据库操作I/O瓶颈。</p>
<p>原因：</p>
<ul>
<li>单库数据量太大</li>
</ul>
<p>瓶颈：单个数据库处理能力有限，单库所在服务器上磁盘空间不足，I/O有限；</p>
<p>解决方法：切分成更多更小的库</p>
<h3 id="分表"><a title="分表" class="headerlink" href="#分表"></a>分表</h3><p>分表从表面意思说就是把一张表分成多个小表，分区则是把一张表的数据分成N多个区块，这些区块可以在同一个磁盘上，也可以在不同的磁盘上。</p>
<p><a target="_blank" rel="noopener" href="https://bbs.huaweicloud.com/blogs/331724#:~:text=Mysql%E7%9A%84%E6%89%A9%E5%B1%95%E6%96%B9%E6%A1%88%E5%8C%85%E6%8B%ACScale%20Out%E5%92%8CScale%20Up%E4%B8%A4%E7%A7%8D%E3%80%82%20Scale,Out%20%28%E6%A8%AA%E5%90%91%E6%89%A9%E5%B1%95%29%E6%98%AF%E6%8C%87Application%E5%8F%AF%E4%BB%A5%E5%9C%A8%E6%B0%B4%E5%B9%B3%E6%96%B9%E5%90%91%E4%B8%8A%E6%89%A9%E5%B1%95%E3%80%82%20%E4%B8%80%E8%88%AC%E5%AF%B9%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%BF%83%E7%9A%84%E5%BA%94%E7%94%A8%E8%80%8C%E8%A8%80%EF%BC%8CScale%20out%E6%8C%87%E7%9A%84%E6%98%AF%E5%BD%93%E6%B7%BB%E5%8A%A0%E6%9B%B4%E5%A4%9A%E7%9A%84%E6%9C%BA%E5%99%A8%E6%97%B6%EF%BC%8C%E5%BA%94%E7%94%A8%E4%BB%8D%E7%84%B6%E5%8F%AF%E4%BB%A5%E5%BE%88%E5%A5%BD%E7%9A%84%E5%88%A9%E7%94%A8%E8%BF%99%E4%BA%9B%E6%9C%BA%E5%99%A8%E7%9A%84%E8%B5%84%E6%BA%90%E6%9D%A5%E6%8F%90%E5%8D%87%E8%87%AA%E5%B7%B1%E7%9A%84%E6%95%88%E7%8E%87%E4%BB%8E%E8%80%8C%E8%BE%BE%E5%88%B0%E5%BE%88%E5%A5%BD%E7%9A%84%E6%89%A9%E5%B1%95%E6%80%A7%E3%80%82">都在这篇文章里</a></p>
<p><a target="_blank" rel="noopener" href="https://developer.aliyun.com/article/694143#:~:text=MySQL%E5%88%86%E5%8C%BA%201.MySQL%E5%88%86%E5%8C%BA%E7%9A%84%E7%A7%8D%E7%B1%BB%20%E8%8C%83%E5%9B%B4%E5%88%86%E5%8C%BA%EF%BC%9A%20RANGE%20Partitioning%20%E5%88%97%E8%A1%A8%E5%88%86%E5%8C%BA%EF%BC%9ALIST%20Partitioning,%E5%88%97%E5%88%86%E5%8C%BA%EF%BC%9ACOLUMNS%20Partitioning%20HASH%E5%88%86%E5%8C%BA%EF%BC%9AHASH%20Partitioning%20KEY%E5%88%86%E5%8C%BA%EF%BC%9AKEY%20Partitioning%20%E5%AD%90%E5%88%86%E5%8C%BA%EF%BC%88%E5%A4%8D%E5%90%88%E5%88%86%E5%8C%BA%EF%BC%89%EF%BC%9ASubpartitioning%EF%BC%88%E4%B8%8D%E5%BB%BA%E8%AE%AE%E4%BD%BF%E7%94%A8%EF%BC%89">关于分区</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/136963357">https://zhuanlan.zhihu.com/p/136963357</a></p>
<h2 id="mysql数据库插入一条数据，具体做了什么事情"><a title="mysql数据库插入一条数据，具体做了什么事情" class="headerlink" href="#mysql数据库插入一条数据，具体做了什么事情"></a>mysql数据库插入一条数据，具体做了什么事情</h2><p>mysql数据库组成：</p>
<p><img loading="lazy" alt="img" src="/images/e6c9d24ely1gzwiv87544j20p40t6jt4.png"></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/354255965">https://zhuanlan.zhihu.com/p/354255965</a></p>
<h2 id="mysql的ACID是怎么实现的"><a title="mysql的ACID是怎么实现的" class="headerlink" href="#mysql的ACID是怎么实现的"></a>mysql的ACID是怎么实现的</h2><blockquote>
<p>事务具有 ACID 四个特性——原子性（Atomicity）、一致性（Consistency）、隔离性（Isolation）、持久性（Durability）。</p>
</blockquote>
<p>先来简单回顾一下 ACID 的定义：</p>
<p>原子性(A)：事务作为一个整体被执行，包含在其中的对数据库的操作要么全部被执行，要么都不执行。</p>
<p>一致性(C)：事务开始前和事务结束后，数据库的完整性没有被破坏。即写入的数据必须完全符合所有的预设约束、触发器、级联回滚等。</p>
<p>隔离性(I)：多个事务并发执行时，一个事务的执行不应影响其他事务的执行。</p>
<p>持久性(D)：已被提交的事务对数据库的修改应该永久保存在数据库中。即使系统挂了，数据也不会丢。</p>
<blockquote>
<p>从数据库层面，数据库通过原子性、隔离性、持久性来保证一致性。也就是说ACID四大特性之中，C(一致性)是目的，A(原子性)、I(隔离性)、D(持久性)是手段，是为了保证一致性，数据库提供的手段。数据库必须要实现AID三大特性，才有可能实现一致性。例如，原子性无法保证，显然一致性也无法保证。</p>
</blockquote>
<h3 id="原子性"><a title="原子性" class="headerlink" href="#原子性"></a>原子性</h3><p>Mysql怎么保证原子性的？</p>
<p>是利用Innodb的undo log。</p>
<p>undo log名为回滚日志，是实现原子性的关键，当事务回滚时能够撤销所有已经成功执行的sql语句，他需要记录你要回滚的相应日志信息。</p>
<p>例如</p>
<p>(1)当你delete一条数据的时候，就需要记录这条数据的信息，回滚的时候，insert这条旧数据<br>(2)当你update一条数据的时候，就需要记录之前的旧值，回滚的时候，根据旧值执行update操作<br>(3)当年insert一条数据的时候，就需要这条记录的主键，回滚的时候，根据主键执行delete操<br>undo log记录了这些回滚需要的信息，当事务执行失败或调用了rollback，导致事务需要回滚，便可以利用undo log中的信息将数据回滚到修改之前的样子。</p>
<h3 id="一致性"><a title="一致性" class="headerlink" href="#一致性"></a>一致性</h3><p>由其它三个特性保证数据的一致性</p>
<h3 id="隔离性"><a title="隔离性" class="headerlink" href="#隔离性"></a>隔离性</h3><blockquote>
<p>Mysql提供了四种隔离级别，其中<code>Repeatable read</code> 是默认的隔离级别</p>
<p>​	<code>select @@tx_isolation;</code></p>
</blockquote>
<table>
<thead>
<tr>
<th>隔离级别</th>
<th>脏读</th>
<th>不可重复读</th>
<th>幻读</th>
</tr>
</thead>
<tbody><tr>
<td>未提交读（Read uncommitted）</td>
<td>允许</td>
<td>允许</td>
<td>不允许</td>
</tr>
<tr>
<td>已提交读（Read committed）</td>
<td>不允许</td>
<td>允许</td>
<td>允许</td>
</tr>
<tr>
<td>可重复读（Repeatable read）</td>
<td>不允许</td>
<td>不允许</td>
<td>允许</td>
</tr>
<tr>
<td>可串行化（Serializable）</td>
<td>不允许</td>
<td>不允许</td>
<td>不允许</td>
</tr>
</tbody></table>
<h4 id="脏读"><a title="脏读" class="headerlink" href="#脏读"></a>脏读</h4><table>
<thead>
<tr>
<th align="center">会话 1</th>
<th align="center">会话2</th>
</tr>
</thead>
<tbody><tr>
<td align="center">begin</td>
<td align="center">begin</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">update table set age=12 where id=1</td>
</tr>
<tr>
<td align="center">select age from table where id=1</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">commit</td>
<td align="center">commit</td>
</tr>
</tbody></table>
<p>读取到会话2中未提交的数据，就是脏读，只有隔离级别是未提交读时，才会出现。</p>
<h4 id="不可重复读"><a title="不可重复读" class="headerlink" href="#不可重复读"></a>不可重复读</h4><p>针对update重复查询两次，得到不一样的结果</p>
<table>
<thead>
<tr>
<th align="center">会话1</th>
<th align="center">会话2</th>
</tr>
</thead>
<tbody><tr>
<td align="center">begin</td>
<td align="center">begin</td>
</tr>
<tr>
<td align="center">select age from table where id=1</td>
<td align="center"></td>
</tr>
<tr>
<td align="center"></td>
<td align="center">update age=10 where id=1</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">commit</td>
</tr>
<tr>
<td align="center">select age from table where id=1</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">commit</td>
<td align="center"></td>
</tr>
</tbody></table>
<p>意思在一个事务中，重复的查询两次，第二次读到了会话2事务中已提交更改数据，从而得到的结果不一致，就叫不可重复读(一致的数据)。</p>
<h4 id="幻读"><a title="幻读" class="headerlink" href="#幻读"></a>幻读</h4><p>针对插入</p>
<table>
<thead>
<tr>
<th align="center">会话1</th>
<th align="center">会话2</th>
</tr>
</thead>
<tbody><tr>
<td align="center">begin</td>
<td align="center">begin</td>
</tr>
<tr>
<td align="center">select * from table where id&gt;2</td>
<td align="center"></td>
</tr>
<tr>
<td align="center"></td>
<td align="center">insert into table(id,age) values(5,10);</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">commit</td>
</tr>
<tr>
<td align="center">select * from table where id&gt;2</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">commit</td>
<td align="center"></td>
</tr>
</tbody></table>
<p>在一个事务中，同样的查询条件查询两次，得到的数据记录条数不一致，能查到其它事务已提交的插入的数据记录。</p>
<p>数据库隔离级别从低到高排序：未提交读—&gt;已提交读—-&gt;可重复读—-&gt;可串行化</p>
<p>隔离级别越高，越能保证数据的完整性和一致性，但是对并发性能的影响也越大。</p>
<h3 id="持久性"><a title="持久性" class="headerlink" href="#持久性"></a>持久性</h3><blockquote>
<p>Mysql怎么保证持久性的？</p>
</blockquote>
<p>还是Innodb的undo log。</p>
<p>我们知道程序修改数据的时候，是先将数据从磁盘加载到内存，然后修改完再由内存写回磁盘。持久化其实就是将内存里的数据写入磁盘。因此，持久性的关键就在于如何保证数据可以由内存顺利写入磁盘。</p>
<p>我们有以下几个方案：</p>
<p>方案一：</p>
<p>加载数据到内存<br>修改内存<br>然后写回磁盘<br>提交事务<br>方案二：</p>
<p>加载数据到内存<br>修改内存<br>提交事务<br>后台写回磁盘</p>
<p>第一种方案，靠谱是靠谱，但频繁 I/O 性能太低，会严重拖累 MySQL 的吞吐量。</p>
<p>第二种方案虽然性能上来了，但如果在第四步时宕机了，而系统认为事务已提交，这时候就会丢失数据了。</p>
<p>那怎么办呢？MySQL 给出的方案是 WAL（Write Ahead Log）机制。WAL 翻译过来就是日志先行的意思。这个日志就是 undo log。具体做法是：</p>
<p>加载数据到内存<br>修改内存<br>写入 redo log<br>提交事务<br>后台写回磁盘<br>如果第五步时系统宕机，也可以通过 redo log 来恢复。</p>
<p>你可能有疑问：写入 undo log 不也有磁盘 I/O 吗？这不是脱了裤子放屁，多此一举吗？写 undo log 和写表的区别就在于顺序写和随机写。MySQL 的表数据是随机存储在磁盘中的，而 undo log 是一块固定大小的连续空间。而磁盘顺序写入要比随机写入快几个数量级。</p>
<p>因此，这种方案即保证了数据的安全，性能上也能够接受。</p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/463783901#:~:text=MySQL%20%E7%9A%84%E8%A1%A8%E6%95%B0%E6%8D%AE%E6%98%AF%E9%9A%8F%E6%9C%BA%E5%AD%98%E5%82%A8%E5%9C%A8%E7%A3%81%E7%9B%98%E4%B8%AD%E7%9A%84%EF%BC%8C%E8%80%8C%20redo%20log%20%E6%98%AF%E4%B8%80%E5%9D%97%E5%9B%BA%E5%AE%9A%E5%A4%A7%E5%B0%8F%E7%9A%84%E8%BF%9E%E7%BB%AD%E7%A9%BA%E9%97%B4%E3%80%82%20%E8%80%8C%E7%A3%81%E7%9B%98%E9%A1%BA%E5%BA%8F%E5%86%99%E5%85%A5%E8%A6%81%E6%AF%94%E9%9A%8F%E6%9C%BA%E5%86%99%E5%85%A5%E5%BF%AB%E5%87%A0%E4%B8%AA%E6%95%B0%E9%87%8F%E7%BA%A7%E3%80%82%20%E5%9B%A0%E6%AD%A4%EF%BC%8C%E8%BF%99%E7%A7%8D%E6%96%B9%E6%A1%88%E5%8D%B3%E4%BF%9D%E8%AF%81%E4%BA%86%E6%95%B0%E6%8D%AE%E7%9A%84%E5%AE%89%E5%85%A8%EF%BC%8C%E6%80%A7%E8%83%BD%E4%B8%8A%E4%B9%9F%E8%83%BD%E5%A4%9F%E6%8E%A5%E5%8F%97%E3%80%82,%E5%8E%9F%E5%AD%90%E6%80%A7%20%E5%81%87%E5%A6%82%E4%B8%80%E4%B8%AA%E4%BA%8B%E5%8A%A1%E5%81%9A%E4%BA%86%E5%A6%82%E4%B8%8B%E6%93%8D%E4%BD%9C%EF%BC%9A%20%E6%8F%92%E5%85%A5%E4%B8%80%E6%9D%A1%E6%95%B0%E6%8D%AE%20insert%20into%20user%20values%20%28%271%27%2C%27%E5%B0%8F%E5%88%98%27%2C%2718%27%29">参考文章1</a></p>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1849815">参考文章2</a></p>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1600883">参考文章3</a></p>
<h2 id="mysql集群部署方式"><a title="mysql集群部署方式" class="headerlink" href="#mysql集群部署方式"></a>mysql集群部署方式</h2><h3 id="MySQL-Replication-主从复制"><a title="MySQL Replication(主从复制)" class="headerlink" href="#MySQL-Replication-主从复制"></a>MySQL Replication(主从复制)</h3><p>MySQL Replication一主多从的结构</p>
<h3 id="MySQL-Fabirc"><a title="MySQL Fabirc" class="headerlink" href="#MySQL-Fabirc"></a>MySQL Fabirc</h3><p>这是在MySQL Replication的基础上，增加了故障检测与转移，自动数据分片功能。不过依旧是一主多从的结构，MySQL Fabirc只有一个主节点，区别是当该主节点挂了以后，会从从节点中选择一个来当主节点。</p>
<h3 id="MySQL-Cluster"><a title="MySQL Cluster" class="headerlink" href="#MySQL-Cluster"></a>MySQL Cluster</h3><p>mysql集群（MySQL Cluster）也是mysql官方提供的。</p>
<p>MySQL Cluster是多主多从结构的</p>
<h3 id="Zookeeper-proxy"><a title="Zookeeper + proxy" class="headerlink" href="#Zookeeper-proxy"></a>Zookeeper + proxy</h3><h3 id="Paxos"><a title="Paxos" class="headerlink" href="#Paxos"></a>Paxos</h3><p>paxos算法？</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/lgx211/p/12456859.html">参考文章</a></p>
<h2 id="如何防止redis雪崩，穿透，击穿"><a title="如何防止redis雪崩，穿透，击穿" class="headerlink" href="#如何防止redis雪崩，穿透，击穿"></a>如何防止redis雪崩，穿透，击穿</h2><h3 id="雪崩"><a title="雪崩" class="headerlink" href="#雪崩"></a>雪崩</h3><p>原因：</p>
<pre><code>1.  大量redis缓存失效，导致数据库被打死
2.  redis服务器挂了
</code></pre>
<p>解决方案：</p>
<ol>
<li>将缓存设置成不同时间点的过期时间(在原有设置过期时间上加一个随机数)</li>
<li>实现redis高可用，Redis Cluster 或者 Redis Sentinel(哨兵) 等方案。</li>
<li>针对某些极少变化的缓存设置为永不过期</li>
</ol>
<h3 id="穿透"><a title="穿透" class="headerlink" href="#穿透"></a>穿透</h3><p>原因：</p>
<p>缓存穿透表示查询一个一定不存在的数据，由于没有获取到缓存，所以没写入缓存，导致这个不存在的数据每次都需要去数据库查询，失去了缓存的意义。</p>
<p>解决方案：</p>
<ol>
<li><p>过滤非法数据，如对于像ID为负数的非法请求直接过滤掉，采用布隆过滤器(Bloom Filter)。</p>
</li>
<li><p>针对在数据库中找不到记录的，我们仍然将该空数据存入缓存中，当然一般会设置一个较短的过期时间(30-60分钟)。</p>
</li>
</ol>
<h3 id="击穿"><a title="击穿" class="headerlink" href="#击穿"></a>击穿</h3><p>原因：针对热点key缓存失效</p>
<p>解决方案：</p>
<ol>
<li>让该热门key的缓存永不过期</li>
<li>使用互斥锁，通过redis的setnx实现互斥锁。</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/100706208">https://zhuanlan.zhihu.com/p/100706208</a></p>
<h2 id="redis有几种存储方式"><a title="redis有几种存储方式" class="headerlink" href="#redis有几种存储方式"></a>redis有几种存储方式</h2><p>Redis有两种持久化的方式：快照（RDB文件）和追加式文件（AOF文件）：</p>
<ul>
<li>RDB持久化方式会在一个特定的间隔保存那个时间点的一个数据快照。</li>
<li>AOF持久化方式则会记录每一个服务器收到的写操作。在服务启动时，这些记录的操作会逐条执行从而重建出原来的数据。写操作命令记录的格式跟Redis协议一致，以追加的方式进行保存。</li>
<li>Redis的持久化是可以禁用的，就是说你可以让数据的生命周期只存在于服务器的运行时间里。</li>
<li>两种方式的持久化是可以同时存在的，但是当Redis重启时，AOF文件会被优先用于重建数据</li>
</ul>
<h2 id="linux系统零拷贝"><a title="linux系统零拷贝" class="headerlink" href="#linux系统零拷贝"></a>linux系统零拷贝</h2><ul>
<li>依赖操作系统底层native api</li>
<li>将传统的读写次数由4次降底到3次, 提高了效率</li>
<li>上下文切换由4次降到2次</li>
</ul>
<p>可见确实是消除了从内核空间到用户空间的来回复制，因此“zero-copy”这个词实际上是站在内核的角度来说的，并不是完全不会发生任何拷贝。</p>
<p>在Java NIO包中提供了零拷贝机制对应的API，即FileChannel.transferTo()方法。不过FileChannel类是抽象类，transferTo()也是一个抽象方法，因此还要依赖于具体实现。FileChannel的实现类并不在JDK本身，而位于sun.nio.ch.FileChannelImpl类中，零拷贝的具体实现自然也都是native方法，看官如有兴趣可以自行查找源码来看，这里不再赘述。</p>
<p>将传统方式的发送端逻辑改写一下，大致如下。</p>
<pre><code>SocketAddress socketAddress = new InetSocketAddress(HOST, PORT);
SocketChannel socketChannel = SocketChannel.open();
socketChannel.connect(socketAddress);

File file = new File(FILE_PATH);
FileChannel fileChannel = new FileInputStream(file).getChannel();
fileChannel.transferTo(0, file.length(), socketChannel);

fileChannel.close();
socketChannel.close();
</code></pre>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1744444">https://cloud.tencent.com/developer/article/1744444</a></p>
<h2 id="两个不同的网站，如何实现登陆状态同步"><a title="两个不同的网站，如何实现登陆状态同步" class="headerlink" href="#两个不同的网站，如何实现登陆状态同步"></a>两个不同的网站，如何实现登陆状态同步</h2><p>其实就是sso原理，oauth2</p>
<h2 id="java8函数式编程用过哪些，举例说明"><a title="java8函数式编程用过哪些，举例说明" class="headerlink" href="#java8函数式编程用过哪些，举例说明"></a>java8函数式编程用过哪些，举例说明</h2><p>Function</p>
<h2 id="对称加密与非对称加密"><a title="对称加密与非对称加密" class="headerlink" href="#对称加密与非对称加密"></a>对称加密与非对称加密</h2>  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/review/">review</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/题目/">题目</a><a href="/tags/review/">review</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="http://clockcoder.com/2023/02/16/2022%E5%B9%B42%E6%9C%88interView/" data-title="2022年2月interView | 小黑的技术博客" data-tsina="1601653200" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2023/02/16/SpringBoot + Redis模拟 10w 人的秒杀抢单/" title="SpringBoot + Redis：模拟 10w 人的秒杀抢单！">
  <strong>上一篇：</strong><br/>
  <span>
  SpringBoot + Redis：模拟 10w 人的秒杀抢单！</span>
</a>
</div>


<div class="next">
<a href="/2022/08/04/2022年7月面试总结/"  title="2022年7月面试总结">
 <strong>下一篇：</strong><br/> 
 <span>2022年7月面试总结
</span>
</a>
</div>

</nav>

	
<section id="comments" class="comment">
	<div class="ds-thread" data-thread-key="2023/02/16/2022年2月interView/" data-title="2022年2月interView" data-url="http://clockcoder.com/2023/02/16/2022%E5%B9%B42%E6%9C%88interView/"></div>
</section>


<section id="comments" class="comment">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>

</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
 
 <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#2022%E5%B9%B42%E6%9C%88interView"><span class="toc-number">1.</span> <span class="toc-text">2022年2月interView</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#jvm%E7%9A%84%E4%B8%A4%E7%A7%8D%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6%EF%BC%8Ccms%E5%92%8Cg1%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86%E5%8F%8A%E5%8C%BA%E5%88%AB"><span class="toc-number">1.1.</span> <span class="toc-text">jvm的两种回收机制，cms和g1的工作原理及区别</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JVM%E8%BF%90%E8%A1%8C%E4%B8%AD%E6%96%B0%E7%94%9F%E4%BB%A3%E5%AF%B9%E8%B1%A1%E5%9C%A8%E4%BB%80%E4%B9%88%E6%83%85%E5%86%B5%E4%B8%8B%EF%BC%8C%E4%BC%9A%E8%A2%AB%E4%B8%8A%E5%8D%87%E5%88%B0%E8%80%81%E5%B9%B4%E4%BB%A3%EF%BC%9F"><span class="toc-number">1.2.</span> <span class="toc-text">JVM运行中新生代对象在什么情况下，会被上升到老年代？</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%8E%E4%B9%88%E5%88%A4%E6%96%AD%E5%AF%B9%E8%B1%A1%E5%8F%AF%E5%9B%9E%E6%94%B6"><span class="toc-number">1.2.1.</span> <span class="toc-text">怎么判断对象可回收</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A0%86%E4%B8%AD%E6%9C%89%E5%AF%B9%E8%B1%A1%E5%8F%AF%E5%9B%9E%E6%94%B6%E6%97%B6%EF%BC%8C%E8%A7%A6%E5%8F%91%E7%9A%84%E5%93%AA%E7%A7%8D%E6%9C%BA%E5%88%B6%E5%9B%9E%E6%94%B6"><span class="toc-number">1.2.2.</span> <span class="toc-text">堆中有对象可回收时，触发的哪种机制回收</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#gc%E6%97%B6%E9%87%87%E7%94%A8%E7%9A%84%E7%AE%97%E6%B3%95"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">gc时采用的算法</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JVM%E6%98%AF%E5%A6%82%E4%BD%95%E4%B8%8Ecpu%E3%80%81%E5%86%85%E5%AD%98%E8%BF%9B%E8%A1%8C%E8%B0%83%E5%BA%A6%E4%BA%A4%E4%BA%92%E7%9A%84"><span class="toc-number">1.3.</span> <span class="toc-text">JVM是如何与cpu、内存进行调度交互的?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%89%E4%B8%AA%E7%A7%92%E6%9D%80%E6%8E%A5%E5%8F%A3%EF%BC%8C%E6%8E%A5%E5%8F%A3%E4%B8%AD%E9%97%B4%E8%B0%83%E7%94%A8%E4%BA%86%E5%87%A0%E4%B8%AA%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%8E%A5%E5%8F%A3%EF%BC%8C%E5%8E%9F%E6%9D%A5%E6%94%AF%E6%8C%811000%E4%B8%AAQPS-%E7%8E%B0%E5%9C%A8%E8%A6%81%E6%B1%82%E4%BC%98%E5%8C%96%EF%BC%8C%E5%B0%86QPS%E6%8F%90%E5%8D%87%E5%88%B01%E4%B8%87-%EF%BC%8C%E6%80%8E%E4%B9%88%E4%BC%98%E5%8C%96"><span class="toc-number">1.4.</span> <span class="toc-text">有个秒杀接口，接口中间调用了几个微服务接口，原来支持1000个QPS, 现在要求优化，将QPS提升到1万+，怎么优化?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%A5%E4%BD%9C%E4%B8%AD%E6%9C%89%E8%A7%A3%E5%86%B3%E8%BF%87%E4%BB%80%E4%B9%88%E9%97%AE%E9%A2%98%EF%BC%8C%E8%A7%A3%E5%86%B3%E6%80%9D%E8%B7%AF%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-number">1.5.</span> <span class="toc-text">工作中有解决过什么问题，解决思路是什么?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E9%87%8D%E5%90%AF%E9%97%AE%E9%A2%98"><span class="toc-number">1.5.1.</span> <span class="toc-text">应用重启问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8C%85%E5%86%B2%E7%AA%81%E5%AF%BC%E8%87%B4%E5%BA%94%E7%94%A8%E8%AE%BF%E9%97%AE%E5%BC%82%E5%B8%B8%E9%97%AE%E9%A2%98"><span class="toc-number">1.5.2.</span> <span class="toc-text">包冲突导致应用访问异常问题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83%E6%8A%80%E6%9C%AF%E9%80%89%E5%9E%8B%EF%BC%8C%E5%90%84%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83%E7%9A%84%E5%8C%BA%E5%88%AB%E4%B8%8E%E4%BC%98%E7%BC%BA%E7%82%B9%EF%BC%8C%E4%B8%BA%E4%BB%80%E4%B9%88%E6%9C%80%E7%BB%88%E9%80%89%E6%8B%A9%E4%BA%86%E9%82%A3%E4%B8%AA"><span class="toc-number">1.6.</span> <span class="toc-text">配置中心技术选型，各配置中心的区别与优缺点，为什么最终选择了那个?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#nacos"><span class="toc-number">1.6.1.</span> <span class="toc-text">nacos</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#apollo"><span class="toc-number">1.6.2.</span> <span class="toc-text">apollo</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#discover-server"><span class="toc-number">1.6.3.</span> <span class="toc-text">discover server</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%89%E4%B8%A4%E4%B8%AAList-%E6%AF%8F%E4%B8%AAlist%E9%83%BD%E6%9C%89100w%E6%9D%A1%E6%95%B0%E6%8D%AE%EF%BC%8C%E7%8E%B0%E5%9C%A8%E8%A6%81%E5%B0%86%E4%B8%A4%E4%B8%AAlist%E4%B8%AD%E7%9A%84%E9%87%8D%E5%A4%8D%E6%95%B0%E6%8D%AE%E5%8F%96%E5%87%BA%E6%9D%A5%EF%BC%8C%E6%9C%89%E4%BB%80%E4%B9%88%E5%8A%9E%E6%B3%95-%E4%B9%9F%E5%8F%AF%E4%BB%A5%E5%80%9F%E5%8A%A9%E7%AC%AC%E4%B8%89%E6%96%B9%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%AE%9E%E7%8E%B0-%EF%BC%9F"><span class="toc-number">1.7.</span> <span class="toc-text">有两个List,每个list都有100w条数据，现在要将两个list中的重复数据取出来，有什么办法(也可以借助第三方中间件实现)？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rabbiMQ-%E9%85%8D%E7%BD%AE%E9%97%AE%E9%A2%98"><span class="toc-number">1.8.</span> <span class="toc-text">rabbiMQ 配置问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E7%BD%AE"><span class="toc-number">1.8.1.</span> <span class="toc-text">服务端配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9B%86%E7%BE%A4%E7%9B%B8%E5%85%B3%E9%85%8D%E7%BD%AE"><span class="toc-number">1.8.1.1.</span> <span class="toc-text">集群相关配置</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#cluster-partition-handling"><span class="toc-number">1.8.1.1.1.</span> <span class="toc-text">cluster_partition_handling</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E5%A4%84%E7%90%86rabbitMQ%E9%9B%86%E7%BE%A4%E8%84%91%E8%A3%82%E9%97%AE%E9%A2%98"><span class="toc-number">1.8.1.1.1.1.</span> <span class="toc-text">如何处理rabbitMQ集群脑裂问题</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#mirroring-sync-batch-size"><span class="toc-number">1.8.1.1.2.</span> <span class="toc-text">mirroring_sync_batch_size</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#rabbitMQ%E9%9B%86%E7%BE%A4%E5%8F%91%E7%8E%B0%E6%9C%BA%E5%88%B6"><span class="toc-number">1.8.1.1.3.</span> <span class="toc-text">rabbitMQ集群发现机制</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AE"><span class="toc-number">1.8.2.</span> <span class="toc-text">客户端配置</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rabbitMQ-%E6%80%8E%E4%B9%88%E4%BF%9D%E8%AF%81100-%E6%B6%88%E6%81%AF%E4%B8%8D%E4%B8%A2%E5%A4%B1"><span class="toc-number">1.9.</span> <span class="toc-text">rabbitMQ 怎么保证100%消息不丢失?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%A0%E4%BB%AC%E5%BE%AE%E6%9C%8D%E5%8A%A1%E7%B3%BB%E7%BB%9F%E4%B8%BB%E8%A6%81%E4%BD%BF%E7%94%A8%E4%BA%86%E5%93%AA%E4%BA%9B%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.10.</span> <span class="toc-text">你们微服务系统主要使用了哪些监控系统</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%93%BE%E8%B7%AF%E8%BF%BD%E8%B8%AA"><span class="toc-number">1.10.1.</span> <span class="toc-text">链路追踪</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7-amp-%E6%8A%A5%E8%AD%A6"><span class="toc-number">1.10.2.</span> <span class="toc-text">性能监控&amp;报警</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A5%E5%BF%97%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.10.3.</span> <span class="toc-text">日志服务</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#springcloud-%E9%99%90%E6%B5%81%E8%AE%BE%E7%BD%AE%E5%85%B7%E4%BD%93%E6%98%AF%E6%80%8E%E4%B9%88%E8%AE%BE%E7%BD%AE%E7%9A%84"><span class="toc-number">1.11.</span> <span class="toc-text">springcloud 限流设置具体是怎么设置的</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#java%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0hash%E8%A1%A8%E7%9A%84"><span class="toc-number">1.12.</span> <span class="toc-text">java如何实现hash表的</span></a></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">1.13.</span> <span class="toc-text"></span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%95%E9%93%BE%E8%A1%A8%E6%9C%89%E4%BB%80%E4%B9%88%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="toc-number">1.14.</span> <span class="toc-text">单链表有什么优缺点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%A8%E8%BF%87%E5%8E%BB%E7%9A%84%E9%A1%B9%E7%9B%AE%E4%B8%AD%EF%BC%8C%E6%98%AF%E5%90%A6%E6%9C%89%E9%80%9A%E8%BF%87%E7%8A%B6%E6%80%81%E6%9C%BA%E5%8E%BB%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%BA%9B%E5%8A%9F%E8%83%BD"><span class="toc-number">1.15.</span> <span class="toc-text">在过去的项目中，是否有通过状态机去实现一些功能</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%86%94%E6%96%AD%E6%9C%BA%E5%88%B6"><span class="toc-number">1.15.1.</span> <span class="toc-text">熔断机制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%84%E5%88%99%E5%BC%95%E6%93%8E"><span class="toc-number">1.15.2.</span> <span class="toc-text">规则引擎</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BE%AE%E6%9C%8D%E5%8A%A1%E7%9A%84%E9%A1%B9%E7%9B%AE%E9%87%8C%E6%98%AF%E7%94%A8%E4%BB%80%E4%B9%88%E6%96%B9%E5%BC%8F%E5%AE%9E%E7%8E%B0%E9%99%90%E6%B5%81%E5%92%8C%E7%86%94%E6%96%AD%E9%99%8D%E7%BA%A7%E7%9A%84"><span class="toc-number">1.16.</span> <span class="toc-text">微服务的项目里是用什么方式实现限流和熔断降级的?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E9%99%90%E6%B5%81"><span class="toc-number">1.16.1.</span> <span class="toc-text">为什么要限流</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%89%E5%87%A0%E7%A7%8D%E9%99%90%E6%B5%81%E6%96%B9%E5%BC%8F"><span class="toc-number">1.16.2.</span> <span class="toc-text">有几种限流方式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%89%E8%AF%B7%E6%B1%82IP%E9%99%90%E6%B5%81"><span class="toc-number">1.16.2.1.</span> <span class="toc-text">按请求IP限流</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%89%E8%AF%B7%E6%B1%82%E5%9C%B0%E5%9D%80%E9%99%90%E6%B5%81"><span class="toc-number">1.16.2.2.</span> <span class="toc-text">按请求地址限流</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%99%90%E6%B5%81%E7%AE%97%E6%B3%95"><span class="toc-number">1.16.3.</span> <span class="toc-text">限流算法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%A4%E7%89%8C%E6%A1%B6%E7%AE%97%E6%B3%95"><span class="toc-number">1.16.3.1.</span> <span class="toc-text">令牌桶算法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BC%8F%E6%A1%B6%E7%AE%97%E6%B3%95"><span class="toc-number">1.16.3.2.</span> <span class="toc-text">漏桶算法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%89%E5%93%AA%E4%BA%9B%E5%AE%9E%E7%8E%B0%E6%A1%86%E6%9E%B6"><span class="toc-number">1.16.4.</span> <span class="toc-text">有哪些实现框架</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#springcloud-zuul"><span class="toc-number">1.16.4.1.</span> <span class="toc-text">springcloud-zuul</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Hystixy"><span class="toc-number">1.16.4.2.</span> <span class="toc-text">Hystixy</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Sentinel"><span class="toc-number">1.16.4.3.</span> <span class="toc-text">Sentinel</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E9%99%8D%E7%BA%A7"><span class="toc-number">1.16.5.</span> <span class="toc-text">为什么要降级</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%99%8D%E7%BA%A7%E7%9A%84%E5%8E%9F%E7%90%86"><span class="toc-number">1.16.6.</span> <span class="toc-text">降级的原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%93%AA%E4%BA%9B%E6%A1%86%E6%9E%B6%E5%AE%9E%E7%8E%B0%E4%BA%86%E9%99%8D%E7%BA%A7"><span class="toc-number">1.16.7.</span> <span class="toc-text">哪些框架实现了降级</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Hystixy-1"><span class="toc-number">1.16.7.1.</span> <span class="toc-text">Hystixy</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Sentinel-1"><span class="toc-number">1.16.7.2.</span> <span class="toc-text">Sentinel</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E6%8E%A5%E5%8F%A3%E7%9A%84%E5%B9%82%E7%AD%89%E6%80%A7"><span class="toc-number">1.17.</span> <span class="toc-text">如何实现接口的幂等性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B9%90%E8%A7%82%E9%94%81"><span class="toc-number">1.17.1.</span> <span class="toc-text">数据库乐观锁</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E5%94%AF%E4%B8%80%E9%94%AEID%E7%BA%A6%E6%9D%9F"><span class="toc-number">1.17.2.</span> <span class="toc-text">全局唯一键ID约束</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%B2%E9%87%8DToken%E4%BB%A4%E7%89%8C"><span class="toc-number">1.17.3.</span> <span class="toc-text">防重Token令牌</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%A0%E9%80%92%E8%AF%B7%E6%B1%82ID-%E8%AE%A4%E8%AF%81key"><span class="toc-number">1.17.4.</span> <span class="toc-text">传递请求ID+认证key</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9C%89%E5%87%A0%E7%A7%8D%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E"><span class="toc-number">1.18.</span> <span class="toc-text">mysql数据库有几种存储引擎</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#innerDB"><span class="toc-number">1.18.1.</span> <span class="toc-text">innerDB</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MyiSam"><span class="toc-number">1.18.2.</span> <span class="toc-text">MyiSam</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E6%B0%B4%E5%B9%B3%E6%96%B9%E5%90%91%E7%9A%84%E6%89%A9%E5%B1%95"><span class="toc-number">1.19.</span> <span class="toc-text">mysql数据库水平方向的扩展</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9E%82%E7%9B%B4-%E7%BA%B5%E5%90%91-%E6%8B%86%E5%88%86%EF%BC%9A"><span class="toc-number">1.19.1.</span> <span class="toc-text">垂直(纵向)拆分：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B0%B4%E5%B9%B3-%E6%A8%AA%E5%90%91-%E6%8B%86%E5%88%86%EF%BC%9A"><span class="toc-number">1.19.2.</span> <span class="toc-text">水平(横向)拆分：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E5%88%86%E5%8C%BA%EF%BC%8C%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E5%88%86%E5%BA%93%EF%BC%8C%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E5%88%86%E8%A1%A8"><span class="toc-number">1.20.</span> <span class="toc-text">数据库什么时候分区，什么时候分库，什么时候分表</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E5%8C%BA"><span class="toc-number">1.20.1.</span> <span class="toc-text">分区</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sharding-%E5%88%86%E7%89%87"><span class="toc-number">1.20.2.</span> <span class="toc-text">sharding(分片)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E5%BA%93"><span class="toc-number">1.20.3.</span> <span class="toc-text">分库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E8%A1%A8"><span class="toc-number">1.20.4.</span> <span class="toc-text">分表</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8F%92%E5%85%A5%E4%B8%80%E6%9D%A1%E6%95%B0%E6%8D%AE%EF%BC%8C%E5%85%B7%E4%BD%93%E5%81%9A%E4%BA%86%E4%BB%80%E4%B9%88%E4%BA%8B%E6%83%85"><span class="toc-number">1.21.</span> <span class="toc-text">mysql数据库插入一条数据，具体做了什么事情</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mysql%E7%9A%84ACID%E6%98%AF%E6%80%8E%E4%B9%88%E5%AE%9E%E7%8E%B0%E7%9A%84"><span class="toc-number">1.22.</span> <span class="toc-text">mysql的ACID是怎么实现的</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E5%AD%90%E6%80%A7"><span class="toc-number">1.22.1.</span> <span class="toc-text">原子性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E8%87%B4%E6%80%A7"><span class="toc-number">1.22.2.</span> <span class="toc-text">一致性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9A%94%E7%A6%BB%E6%80%A7"><span class="toc-number">1.22.3.</span> <span class="toc-text">隔离性</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%84%8F%E8%AF%BB"><span class="toc-number">1.22.3.1.</span> <span class="toc-text">脏读</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8D%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB"><span class="toc-number">1.22.3.2.</span> <span class="toc-text">不可重复读</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B9%BB%E8%AF%BB"><span class="toc-number">1.22.3.3.</span> <span class="toc-text">幻读</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%81%E4%B9%85%E6%80%A7"><span class="toc-number">1.22.4.</span> <span class="toc-text">持久性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mysql%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E6%96%B9%E5%BC%8F"><span class="toc-number">1.23.</span> <span class="toc-text">mysql集群部署方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL-Replication-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6"><span class="toc-number">1.23.1.</span> <span class="toc-text">MySQL Replication(主从复制)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL-Fabirc"><span class="toc-number">1.23.2.</span> <span class="toc-text">MySQL Fabirc</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL-Cluster"><span class="toc-number">1.23.3.</span> <span class="toc-text">MySQL Cluster</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Zookeeper-proxy"><span class="toc-number">1.23.4.</span> <span class="toc-text">Zookeeper + proxy</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Paxos"><span class="toc-number">1.23.5.</span> <span class="toc-text">Paxos</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E9%98%B2%E6%AD%A2redis%E9%9B%AA%E5%B4%A9%EF%BC%8C%E7%A9%BF%E9%80%8F%EF%BC%8C%E5%87%BB%E7%A9%BF"><span class="toc-number">1.24.</span> <span class="toc-text">如何防止redis雪崩，穿透，击穿</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%AA%E5%B4%A9"><span class="toc-number">1.24.1.</span> <span class="toc-text">雪崩</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A9%BF%E9%80%8F"><span class="toc-number">1.24.2.</span> <span class="toc-text">穿透</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BB%E7%A9%BF"><span class="toc-number">1.24.3.</span> <span class="toc-text">击穿</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#redis%E6%9C%89%E5%87%A0%E7%A7%8D%E5%AD%98%E5%82%A8%E6%96%B9%E5%BC%8F"><span class="toc-number">1.25.</span> <span class="toc-text">redis有几种存储方式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#linux%E7%B3%BB%E7%BB%9F%E9%9B%B6%E6%8B%B7%E8%B4%9D"><span class="toc-number">1.26.</span> <span class="toc-text">linux系统零拷贝</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%A4%E4%B8%AA%E4%B8%8D%E5%90%8C%E7%9A%84%E7%BD%91%E7%AB%99%EF%BC%8C%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%99%BB%E9%99%86%E7%8A%B6%E6%80%81%E5%90%8C%E6%AD%A5"><span class="toc-number">1.27.</span> <span class="toc-text">两个不同的网站，如何实现登陆状态同步</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#java8%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B%E7%94%A8%E8%BF%87%E5%93%AA%E4%BA%9B%EF%BC%8C%E4%B8%BE%E4%BE%8B%E8%AF%B4%E6%98%8E"><span class="toc-number">1.28.</span> <span class="toc-text">java8函数式编程用过哪些，举例说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E4%B8%8E%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86"><span class="toc-number">1.29.</span> <span class="toc-text">对称加密与非对称加密</span></a></li></ol></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  
<div class="github-card">
<p class="asidetitle">Github 名片</p>
<div class="github-card" data-github="huguiqi" data-width="220" data-height="119" data-theme="medium">
<script type="text/javascript" src="//cdn.jsdelivr.net/github-cards/latest/widget.js" ></script>
</div>
  </div>



  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
		  
			<li><a href="/categories/AFNetWork3-1/" title="AFNetWork3.1">AFNetWork3.1<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/AI/" title="AI">AI<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/Alcatraz/" title="Alcatraz">Alcatraz<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/IT-运维/" title="IT&amp;运维">IT&amp;运维<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/activiti/" title="activiti">activiti<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/AI/chatGPT/" title="chatGPT">chatGPT<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/devops/" title="devops">devops<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/docker/" title="docker">docker<sup>5</sup></a></li>
		  
		
		  
			<li><a href="/categories/rpc/dubbo/" title="dubbo">dubbo<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/git/" title="git">git<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/github-博客/" title="github 博客">github 博客<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/hexo/" title="hexo">hexo<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/hexo插件/" title="hexo插件">hexo插件<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/iOS/" title="iOS">iOS<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/ios-Developer/" title="ios Developer">ios Developer<sup>5</sup></a></li>
		  
		
		  
			<li><a href="/categories/java/" title="java">java<sup>11</sup></a></li>
		  
		
		  
			<li><a href="/categories/javascript/" title="javascript">javascript<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/k8s/" title="k8s">k8s<sup>6</sup></a></li>
		  
		
		  
			<li><a href="/categories/kafka/" title="kafka">kafka<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/maven/" title="maven">maven<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/k8s/minikube/" title="minikube">minikube<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/mysql/" title="mysql">mysql<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/系统-运维/nginx/" title="nginx">nginx<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/node/" title="node">node<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/nodejs/" title="nodejs">nodejs<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/kafka/nodejs/" title="nodejs">nodejs<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/postgresql/" title="postgresql">postgresql<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/python/" title="python">python<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/rabbitMQ/" title="rabbitMQ">rabbitMQ<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/rabbitmq/" title="rabbitmq">rabbitmq<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/redis/" title="redis">redis<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/review/" title="review">review<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/rpc/" title="rpc">rpc<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/springboot/skywalking/" title="skywalking">skywalking<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/sonarqube/" title="sonarqube">sonarqube<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/springCloud/" title="springCloud">springCloud<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/springboot/" title="springboot">springboot<sup>8</sup></a></li>
		  
		
		  
			<li><a href="/categories/activiti/springboot/" title="springboot">springboot<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/springcloud/" title="springcloud">springcloud<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/xcode/" title="xcode">xcode<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/专业技术/" title="专业技术">专业技术<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/专业技术-印象笔记/" title="专业技术(印象笔记)">专业技术(印象笔记)<sup>222</sup></a></li>
		  
		
		  
			<li><a href="/categories/分布式/" title="分布式">分布式<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/前端技术/" title="前端技术">前端技术<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/加密解密/" title="加密解密">加密解密<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/区块链/加密货币/" title="加密货币">加密货币<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/区块链/" title="区块链">区块链<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/大数据/" title="大数据">大数据<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/延迟队列/" title="延迟队列">延迟队列<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/感悟/" title="感悟">感悟<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/杂谈/" title="杂谈">杂谈<sup>8</sup></a></li>
		  
		
		  
			<li><a href="/categories/消息中间件/" title="消息中间件">消息中间件<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/网络/破解/" title="破解">破解<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/科学上网/" title="科学上网">科学上网<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/站内搜索-博客/" title="站内搜索 博客">站内搜索 博客<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/管理/" title="管理">管理<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/系统/" title="系统">系统<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/系统-工具/" title="系统&amp;工具">系统&amp;工具<sup>6</sup></a></li>
		  
		
		  
			<li><a href="/categories/系统-运维/" title="系统&amp;运维">系统&amp;运维<sup>35</sup></a></li>
		  
		
		  
			<li><a href="/categories/网络/" title="网络">网络<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/系统-运维/网络配置/" title="网络配置">网络配置<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/网络配置/" title="网络配置">网络配置<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/读书笔记/" title="读书笔记">读书笔记<sup>5</sup></a></li>
		  
		
		  
			<li><a href="/categories/路由器/" title="路由器">路由器<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/软件规划/" title="软件规划">软件规划<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/系统-运维/镜像/" title="镜像">镜像<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/随笔/" title="随笔">随笔<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/面试/" title="面试">面试<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/面试整理/" title="面试整理">面试整理<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/面试题/" title="面试题">面试题<sup>1</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/从印象笔记导入/" title="从印象笔记导入">从印象笔记导入<sup>222</sup></a></li>
			
		
			
				<li><a href="/tags/k8s/" title="k8s">k8s<sup>11</sup></a></li>
			
		
			
				<li><a href="/tags/springboot/" title="springboot">springboot<sup>9</sup></a></li>
			
		
			
				<li><a href="/tags/随笔/" title="随笔">随笔<sup>8</sup></a></li>
			
		
			
				<li><a href="/tags/docker/" title="docker">docker<sup>7</sup></a></li>
			
		
			
				<li><a href="/tags/redis/" title="redis">redis<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/nginx/" title="nginx">nginx<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/hexo/" title="hexo">hexo<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/nodejs/" title="nodejs">nodejs<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/chatGPT/" title="chatGPT">chatGPT<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/AI/" title="AI">AI<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/spring-cloud/" title="spring cloud">spring cloud<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/面试题/" title="面试题">面试题<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/Rejected/" title="Rejected">Rejected<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/rabbitMQ/" title="rabbitMQ">rabbitMQ<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/路由器/" title="路由器">路由器<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/nexus/" title="nexus">nexus<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/ReactNative/" title="ReactNative">ReactNative<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/postgresql/" title="postgresql">postgresql<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/centos7/" title="centos7">centos7<sup>2</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="http://clockcoder.com" target="_blank" title="承接手机app、微信、web开发">找人做软件</a>
            
          </li>
        
    </ul>
</div>

  

<div class="doubanshow">
<p class="asidetitle">豆瓣秀</p>
<div>
<script type="text/javascript" src="http://www.douban.com/service/badge/64698454/?show=collection&amp;n=12&amp;columns=3&amp;hidelogo=yes&amp;hideself=yes&amp;cat=book|movie" ></script>
</div>
</div>


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

  <div class="weiboshow">
  <p class="asidetitle">新浪微博</p>
    <iframe width="100%" height="119" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=119&fansRow=2&ptype=1&speed=0&skin=9&isTitle=1&noborder=1&isWeibo=0&isFans=0&uid=1601653200&verifier=bd864c6a&dpc=1"></iframe>
</div>


</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello ,I&#39;m Sam.This is my Blog. <br/>
			Anything that can go wrong will go wrong</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/1601653200" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		<a href="https://github.com/huguiqi" target="_blank" class="icon-github" title="github"></a>
		
		
		
		<a href="https://twitter.com/XiaoheiSpring" target="_blank" class="icon-twitter" title="twitter"></a>
		
		
		<a href="https://www.facebook.com/sam.hu.7334" target="_blank" class="icon-facebook" title="facebook"></a>
		
		
		<a href="https://www.linkedin.com/in/小黑-胡-ab83b992" target="_blank" class="icon-linkedin" title="linkedin"></a>
		
		
		<a href="https://www.douban.com/people/64698454" target="_blank" class="icon-douban" title="豆瓣"></a>
		
		
		<a href="http://www.zhihu.com/people/hu-xiao-hei-53" target="_blank" class="icon-zhihu" title="知乎"></a>
		
		
		<a href="https://plus.google.com/109318125124422212783?rel=author" target="_blank" class="icon-google_plus" title="Google+"></a>
		
		
		<a href="mailto:guiqi.hu@163.com" target="_blank" class="icon-email" title="Email Me"></a>
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="http://blog.huguiqi.com." target="_blank" title="sam">sam</a> © 2023 
		
		<a href="/about" target="_blank" title="sam">sam</a>
		
		
		</p>
</div>

 <script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');
  
  _st('install','qtnHgvQyg5N9h4en-9wA','2.0.0');
</script>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>



<script type="text/javascript">
  var duoshuoQuery = {short_name:"小黑_spring"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 


<script type="text/javascript">

var disqus_shortname = 'huguiqicom';

(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>






<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?f5971877c7b77f98074be3ddabf34fbe";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
