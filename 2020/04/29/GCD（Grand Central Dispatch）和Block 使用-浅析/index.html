
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
  <meta name="keywords" content="胡小黑,架构师,资深软件工程师,object-c,swift,java,node,小黑,技术,大牛,阿里巴巴,腾讯,旅游">
  
  
    <title>GCD（Grand Central Dispatch）和Block 使用-浅析 | 小黑的技术博客</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="sam">
    
    <meta name="baidu-site-verification" content="zBj0BDqjSV" />
    
    <meta name="description" content="GCD（Grand Central Dispatch）和Block 使用-浅析GCD（Grand Central Dispatch）和Block 使用-浅析(2013-03-2721:25:59)\ \ 转载\ ▼\标签：gcdgcd浅析iosblockxcode\分类：帮助文档\正文开始\\">
<meta name="keywords" content="从印象笔记导入">
<meta property="og:type" content="article">
<meta property="og:title" content="GCD（Grand Central Dispatch）和Block 使用-浅析">
<meta property="og:url" content="http://www.huguiqi.top/2020/04/29/GCD（Grand Central Dispatch）和Block 使用-浅析/index.html">
<meta property="og:site_name" content="小黑的技术博客">
<meta property="og:description" content="GCD（Grand Central Dispatch）和Block 使用-浅析GCD（Grand Central Dispatch）和Block 使用-浅析(2013-03-2721:25:59)\ \ 转载\ ▼\标签：gcdgcd浅析iosblockxcode\分类：帮助文档\正文开始\\">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://www.huguiqi.top/2020/04/29/GCD（Grand%20Central%20Dispatch）和Block%20使用-浅析/GCD%EF%BC%88Grand%20Central%20Dispatch%EF%BC%89%E5%92%8CBlock%20%E4%BD%BF%E7%94%A8-%E6%B5%85%E6%9E%90.resources/FE882AC2-384F-4A0B-B6B8-C1035FBA0CCB.gif">
<meta property="og:updated_time" content="2020-04-29T03:23:56.116Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="GCD（Grand Central Dispatch）和Block 使用-浅析">
<meta name="twitter:description" content="GCD（Grand Central Dispatch）和Block 使用-浅析GCD（Grand Central Dispatch）和Block 使用-浅析(2013-03-2721:25:59)\ \ 转载\ ▼\标签：gcdgcd浅析iosblockxcode\分类：帮助文档\正文开始\\">
<meta name="twitter:image" content="http://www.huguiqi.top/2020/04/29/GCD（Grand%20Central%20Dispatch）和Block%20使用-浅析/GCD%EF%BC%88Grand%20Central%20Dispatch%EF%BC%89%E5%92%8CBlock%20%E4%BD%BF%E7%94%A8-%E6%B5%85%E6%9E%90.resources/FE882AC2-384F-4A0B-B6B8-C1035FBA0CCB.gif">
<meta name="twitter:creator" content="@XiaoheiSpring">
<link rel="publisher" href="109318125124422212783">

    
    <link rel="alternative" href="/atom.xml" title="小黑的技术博客" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css">

</head>

  <body>
    <header>
      
<div>
<p>Hosted by <a href="https://pages.coding.me" style="font-weight: bold">Coding Pages</a></p>

		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="小黑的技术博客" title="小黑的技术博客"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="小黑的技术博客">小黑的技术博客</a></h1>
				<h2 class="blog-motto">不积跬步无以至千里</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">主页</a></li>
					
						<li><a href="/archives">归档</a></li>
					
						<li><a href="/about">关于</a></li>
					
					<li><a href="http://blog.huguiqi.com.">副站</a></li>
					<li>
 					
						<form class="search" action="/search/index.html" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="text" id="search" autocomplete="on" class="st-default-search-input"  name="q" maxlength="30" placeholder="搜索" />
					</form>
					
					</li>
				</ul>
			</nav>			
</div>

    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2020/04/29/GCD（Grand Central Dispatch）和Block 使用-浅析/" title="GCD（Grand Central Dispatch）和Block 使用-浅析" itemprop="url">GCD（Grand Central Dispatch）和Block 使用-浅析</a>
  </h1>
  <p class="article-author">By
       
		<a href="https://plus.google.com/109318125124422212783?rel=author" title="sam" target="_blank" itemprop="author">sam</a>
		
  <p class="article-time">
    <time datetime="2020-04-29T03:23:56.108Z" itemprop="datePublished"> 发表于 2020-04-29</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		
			<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#GCD（Grand-Central-Dispatch）和Block-使用-浅析"><span class="toc-number">1.</span> <span class="toc-text">GCD（Grand Central Dispatch）和Block 使用-浅析</span></a></li></ol>
		
		</div>
		
		<h1 id="GCD（Grand-Central-Dispatch）和Block-使用-浅析"><a href="#GCD（Grand-Central-Dispatch）和Block-使用-浅析" class="headerlink" title="GCD（Grand Central Dispatch）和Block 使用-浅析"></a>GCD（Grand Central Dispatch）和Block 使用-浅析</h1><p><span style="font: 18.0px Times; font-kerning: none; color: #006b77; -webkit-text-stroke: 0px #006b77">GCD（Grand Central Dispatch）和Block 使用-浅析</span><br><span style="font: 10.0px Arial; font-kerning: none; color: #637160; -webkit-text-stroke: 0px #637160">(2013-03-27<br>21:25:59)</span><span style="font: 12.0px Verdana; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br> <span style="font-kerning: none"><img src="GCD%EF%BC%88Grand%20Central%20Dispatch%EF%BC%89%E5%92%8CBlock%20%E4%BD%BF%E7%94%A8-%E6%B5%85%E6%9E%90.resources/FE882AC2-384F-4A0B-B6B8-C1035FBA0CCB.gif" alt="">\<br> 转载</span><span style="font: 7.0px Verdana; font-kerning: none">\<br> ▼\<br></span></span><span style="font: 12.0px Times; font-kerning: none; color: #637160; -webkit-text-stroke: 0px #637160">标签：</span><br><span style="font: 12.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32"><a href="http://search.sina.com.cn/?c=blog&amp;q=gcd&amp;by=tag" target="_blank" rel="noopener"><span style="font-kerning: none; color: #006b77; -webkit-text-stroke: 0px #006b77">gcd</span></a><br><span style="font-kerning: none; color: #006b77; -webkit-text-stroke: 0px #006b77">gcd浅析</span><br><a href="http://search.sina.com.cn/?c=blog&amp;q=ios&amp;by=tag" target="_blank" rel="noopener"><span style="font-kerning: none; color: #006b77; -webkit-text-stroke: 0px #006b77">ios</span></a><br><a href="http://search.sina.com.cn/?c=blog&amp;q=block&amp;by=tag" target="_blank" rel="noopener"><span style="font-kerning: none; color: #006b77; -webkit-text-stroke: 0px #006b77">block</span></a><br><a href="http://search.sina.com.cn/?c=blog&amp;q=xcode&amp;by=tag" target="_blank" rel="noopener"><span style="font-kerning: none; color: #006b77; -webkit-text-stroke: 0px #006b77">xcode</span></a>\<br></span><span style="font: 12.0px Times; font-kerning: none; color: #637160; -webkit-text-stroke: 0px #637160">分类：</span><br><span style="font: 12.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32"><a href="http://blog.sina.com.cn/s/articlelist_2073912495_5_1.html" target="_blank" rel="noopener"><span style="font-kerning: none; color: #006b77; -webkit-text-stroke: 0px #006b77">帮助文档</span></a>\<br></span><span style="font: 12.0px Verdana; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">正文开始</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br>\</span></p>
<a id="more"></a>
<p>关于GCD，我想我前面的有些博客已经介绍的很清楚了。我们就来谈一下它单纯的入门级别的应用。\<br>\<br><span style="font: 14.0px STFangsong; font-kerning: none; color: #23b14b; -webkit-text-stroke: 0px #23b14b">Grand<br>Central Dispatch,或者简称 GCD,是一个与 Block Object 产生工作的低级的 C<br>API。GCD<br>真正的用途是将任务分配到多个核心又不让程序员担心哪个内核执行哪个任务。<br>在 Max OS X<br>上,多内核设备,包括笔记本,用户已经使用了相当长的时间。通过多核设备 比如<br>iPad2 的介绍,程序员能为 iOS 写出神奇的多核多线程 APP。</span><span style="font: 14.0px STFangsong; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 14.0px STFangsong; font-kerning: none; color: #23b14b; -webkit-text-stroke: 0px #23b14b">GCD<br>的核心是分派队列。不论在 iOS 还是 Max OS X 分派队列,正如我们快看到的是<br>由位于主操作系统的 GCD<br>来管理的线程池。你不会直接与线程有工作关系。你只在分派队<br>列上工作,将任务分派到这个队列上并要求队列来调用你的任务。GCD<br>为运行任务提供了 几个选择:同步执行、异步执行和延迟执行等。</span><span style="font: 14.0px STFangsong; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br> GCD+Block 可以是一对好兄弟啊！配合起来使用真的太犀利！\</span></p>
<p>GCD和Block都是苹果后来推崇的方式。GCD，自我感觉主要封装了多线程编程的复杂性！而且，使用方便。\<br> Block<br>主要就是语法类似C的一种块语言。对某一个功能控制有了更好的封装，比如可以调用对象内变量，无需再传参；可以在实现方法中直接写实现后的代码，而不用再进行委托跳转，使代码更加简洁。等等，好处多多吧，自己体会！\<br>\<br> 那就开始吧！\<br> 先看一个例子：\<br>\<br><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830"> \<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">主线程队列，由系统自动创建并且与应用撑血的主线程相关联。\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Times; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">dispatch_queue_t</span><br><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #000000">mainQueue<br>=</span> <span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">dispatch_get_main_queue</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #000000">();</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br>     \<br></span><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//<br>要在主线程队列中，执行的Block\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">   </span><br><span style="font: 14.0px Times; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_async</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(mainQueue,<br>\^(</span><span style="font: 14.0px Times; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">void</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">)<br>{\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000"><br>[[[</span><span style="font: 14.0px Times; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">UIAlertView</span><br><span style="font: 14.0px Times; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">alloc</span><span style="font: 14.0px Times; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">]</span><br><span style="font: 14.0px Times; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">initWithTitle</span><span style="font: 14.0px Times; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">:</span><span style="font: 14.0px Times; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “GCD”</span><span style="font: 14.0px Times; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">                                   </span><br><span style="font: 14.0px Times; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">message</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">:</span><span style="font: 14.0px Times; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “GCD<br>is amazing!”</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br>                                   </span> <span style="font: 14.0px Times; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">delegate</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">:</span><span style="font: 14.0px Times; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">nil</span><br><span style="font: 14.0px Times; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">cancelButtonTitle</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">:</span><span style="font: 14.0px Times; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “OK”</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br>                          </span> <span style="font: 14.0px Times; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">otherButtonTitles</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">:</span><span style="font: 14.0px Times; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">nil</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">,</span><br><span style="font: 14.0px Times; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">nil</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">]</span><br><span style="font: 14.0px Times; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">show</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">];\<br>     });\<br>\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">dispatch_get_main_queue</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">()\<br>\<br> 用来得到主队列。主队列又系统自动创建并且与应用程序主线程相关联。\<br> 也就是我们常说的能调用主线程修改UI的队列，即：主线程队列。\<br></span><span style="font: 19.0px 'Lucida Grande'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br> dispatch_async 方法</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br>\<br></span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666"> void<br>dispatch_async(dispatch_queue_t queue,dispatch_block_t block);\<br>\<br> queue：队列</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">block：代码Block</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">根据指定的队列执行相应的Block。\<br>\<br></span><span style="font: 19.0px 'Lucida Grande'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">dispatch_async_f<br>方法\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">void<br>dispatch_async_f(dispatch_queue_t queue,void<br>*context,dispatch_function_t work);\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">queue</span><span style="font: 13.0px Times; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">：指定执行该</span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">work</span><span style="font: 13.0px Times; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">的队列\<br>\<br></span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">void<br>*context</span><span style="font: 13.0px Times; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">：所使用的</span><br><span style="font: 13.0px 'Lucida Grande'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #000000">application-defined</span><span style="font: 13.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #000000">（</span><span style="font: 13.0px Times; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">应用程序范围内有效的，也就是全局的</span><span style="font: 13.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #000000">）级别的参数。</span><span style="font: 13.0px Times; font-kerning: none; color: #ed2324; -webkit-text-stroke: 0px #ed2324">这是个C语法，void<br>* 是一个无类型指针。也就是说，用它可以指向任何内存数据。</span><span style="font: 13.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 13.0px Times; font-kerning: none; color: #ed2324; -webkit-text-stroke: 0px #ed2324">\<br></span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">work</span><span style="font: 13.0px Times; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">：在指定队列（</span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">queue</span><br><span style="font: 13.0px Times; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">参数）中要执行的方法。在该方法中，第一个参数所指代的数据，也就是</span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">dispatch_async_f</span><span style="font: 13.0px Times; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">方法所使用的第二个参数（</span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">void<br>*context</span><span style="font: 13.0px Times; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">）所指带的数据。\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br> 例子：\<br>\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">定义结构体\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">typedef<br>struct</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #000000">{</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">char</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">*title;\<br>    </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">char</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">*message;\<br>    </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">char</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">*cancelButtonTitle;\<br> } AlertViewData;\<br></span><span style="font: 12.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br>\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">定义</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">dispatch_function_t</span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">所执行的方法</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">void</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">displayAlertView(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">void</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">*paramContext){\<br>    </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #4b8186; -webkit-text-stroke: 0px #4b8186">AlertViewData</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">*alertData<br>= (</span><span style="font: 14.0px Menlo; font-kerning: none; color: #4b8186; -webkit-text-stroke: 0px #4b8186">AlertViewData</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">*)paramContext;\<br>     \<br>    </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">NSString</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">*title<br>=[</span><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">NSString</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">stringWithUTF8String</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">:alertData-&gt;</span><span style="font: 14.0px Menlo; font-kerning: none; color: #4b8186; -webkit-text-stroke: 0px #4b8186">title</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">];\<br>    </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">NSString</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">*message<br>=[</span><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">NSString</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">stringWithUTF8String</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">:alertData-&gt;</span><span style="font: 14.0px Menlo; font-kerning: none; color: #4b8186; -webkit-text-stroke: 0px #4b8186">message</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">];\<br>    </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">NSString</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">*cancelButtonTitle<br>=[</span><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">NSString</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">stringWithUTF8String</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">:alertData-&gt;</span><span style="font: 14.0px Menlo; font-kerning: none; color: #4b8186; -webkit-text-stroke: 0px #4b8186">cancelButtonTitle</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">];\<br>     \<br>     [[[</span><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">UIAlertView</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">alloc</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">]</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">initWithTitle</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">:title</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">message</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">:message\<br>                               </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">delegate</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">:</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">nil</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br>                      </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">cancelButtonTitle</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">:cancelButtonTitle</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">otherButtonTitles</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">:</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">nil</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">,</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">nil</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">]</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">show</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">];\<br>     \<br>     \<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">释放结构体所占用的内存\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">free</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(alertData);\<br>     \<br> }\<br></span><span style="font: 12.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br>\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//<br>**</span><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">执行</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">dispatch_async_f\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">    \<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">dispatch_queue_t</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">mainQueue<br>=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">dispatch_get_main_queue</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">();</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">    \<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">为结构体分配内存\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #4b8186; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #4b8186; -webkit-text-stroke: 0px #4b8186">AlertViewData</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #4b8186; -webkit-text-stroke: 0px #000000">*context<br>= (</span><span style="font: 14.0px Menlo; font-kerning: none; color: #4b8186; -webkit-text-stroke: 0px #4b8186">AlertViewData</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #4b8186; -webkit-text-stroke: 0px #000000">*)</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">malloc</span><span style="font: 14.0px Menlo; font-kerning: none; color: #4b8186; -webkit-text-stroke: 0px #000000">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">sizeof</span><span style="font: 14.0px Menlo; font-kerning: none; color: #4b8186; -webkit-text-stroke: 0px #000000">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #4b8186; -webkit-text-stroke: 0px #4b8186">AlertViewData</span><span style="font: 14.0px Menlo; font-kerning: none; color: #4b8186; -webkit-text-stroke: 0px #000000">));</span><span style="font: 14.0px Menlo; font-kerning: none; color: #4b8186; -webkit-text-stroke: 0px #4b8186">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">    \<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">初始化结构体</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">if</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(context<br>!=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">NULL</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">){\<br>         context-&gt;</span><span style="font: 14.0px Menlo; font-kerning: none; color: #4b8186; -webkit-text-stroke: 0px #4b8186">title</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">=</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24">“GCD”</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">;\<br>         context-&gt;</span><span style="font: 14.0px Menlo; font-kerning: none; color: #4b8186; -webkit-text-stroke: 0px #4b8186">message</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">=</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24">“GCD<br>is amazing.”</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">;\<br>         context-&gt;</span><span style="font: 14.0px Menlo; font-kerning: none; color: #4b8186; -webkit-text-stroke: 0px #4b8186">cancelButtonTitle</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">=</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24">“OK”</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">;\<br>         \<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #000000">       </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//<br>GCD</span><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">执行异步方法：指定主队列（</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">mainQueue</span><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">），传递结构体数据（</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">context</span><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">）来执行</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">displayAlertView</span><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">方法。</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">       </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_async_f</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(mainQueue,(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">void</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">*)context,</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #2e595d; -webkit-text-stroke: 0px #2e595d">displayAlertView</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">);\<br>     }\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br> 有了上面的说明铺垫，我想很快就能明白其中的含义了！\<br>\<br></span><span style="font: 19.0px 'Lucida Grande'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">dispatch_async<br>方法\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666"> void<br>dispatch_async(dispatch_queue_t queue,dispatch_block_t block);\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br> 在指定的队列上，执行响应的Block。\<br>\<br> 例子：\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">dispatch_queue_t</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">mainQueue1<br>=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">dispatch_get_main_queue</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">();</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_async</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(mainQueue1,<br>\^(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">void</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">)<br>{\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">       </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">NSLog</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “Current<br>thread = % “</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">,<br>[</span><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">NSThread</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">currentThread</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">]);</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">       </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">NSLog</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “Main<br>thread = % “</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">,<br>[</span><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">NSThread</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">mainThread</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">]);</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32"><br>});\<br></span><span style="font: 12.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br>\<br> 输出：\<br></span><span style="font: 11.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32"><strong>2013-03-27<br>15:45:54.501 DemoVideo[21802:707] Current thread = {name = (null), num<br>= 1}</strong>\<br> <strong>2013-03-27 15:45:54.503 DemoVideo[21802:707] Main thread = {name =<br>(null), num = 1}</strong>\<br></span><span style="font: 12.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br> 可见，</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">dispatch_get_main_queue</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">()</span><br><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">队列所执行的Block就是在主线程上执行的。</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 20.0px Times; font-kerning: none; color: #23b14b; -webkit-text-stroke: 0px #23b14b"><strong>用GCD<br>同步执行Non-UI-Related 任务</strong></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br>\<br> 同步：\<br></span><span style="font: 14.0px STSong; font-kerning: none; color: #ed2324; -webkit-text-stroke: 0px #ed2324">例如</span><span style="font: 14.0px Times; font-kerning: none; color: #ed2324; -webkit-text-stroke: 0px #ed2324">,</span><span style="font: 14.0px STSong; font-kerning: none; color: #ed2324; -webkit-text-stroke: 0px #ed2324">你想下载一个图片并想在下载完成之后展现给用<br>户。下载过程却和</span> <span style="font: 14.0px 'Times New Roman'; font-kerning: none; color: #ed2324; -webkit-text-stroke: 0px #ed2324">UI</span><br><span style="font: 14.0px STSong; font-kerning: none; color: #ed2324; -webkit-text-stroke: 0px #ed2324">没有任何关系。对于任何与</span><br><span style="font: 14.0px 'Times New Roman'; font-kerning: none; color: #ed2324; -webkit-text-stroke: 0px #ed2324">UI</span><br><span style="font: 14.0px STSong; font-kerning: none; color: #ed2324; -webkit-text-stroke: 0px #ed2324">无关的任务</span><span style="font: 14.0px Times; font-kerning: none; color: #ed2324; -webkit-text-stroke: 0px #ed2324">,</span><span style="font: 14.0px STSong; font-kerning: none; color: #ed2324; -webkit-text-stroke: 0px #ed2324">你可以使用</span><br><span style="font: 14.0px 'Times New Roman'; font-kerning: none; color: #ed2324; -webkit-text-stroke: 0px #ed2324">GCD</span><br><span style="font: 14.0px STSong; font-kerning: none; color: #ed2324; -webkit-text-stroke: 0px #ed2324">中的全<br>局并发队列。它们允许同步和异步执行。如果你同步提交一个任务到一个并发队列</span><span style="font: 14.0px Times; font-kerning: none; color: #ed2324; -webkit-text-stroke: 0px #ed2324">,</span><span style="font: 14.0px STSong; font-kerning: none; color: #ed2324; -webkit-text-stroke: 0px #ed2324">同时提交另一个同步任务到另一个并发队列</span><span style="font: 14.0px Times; font-kerning: none; color: #ed2324; -webkit-text-stroke: 0px #ed2324">;</span><span style="font: 14.0px STSong; font-kerning: none; color: #ed2324; -webkit-text-stroke: 0px #ed2324">相对而言这两个同步任务将异步运行</span><span style="font: 14.0px Times; font-kerning: none; color: #ed2324; -webkit-text-stroke: 0px #ed2324">,</span><span style="font: 14.0px STSong; font-kerning: none; color: #ed2324; -webkit-text-stroke: 0px #ed2324">因为他们运行在两个不同的并发队<br>列上。你想确定在</span> <span style="font: 14.0px 'Times New Roman'; font-kerning: none; color: #ed2324; -webkit-text-stroke: 0px #ed2324">B</span><br><span style="font: 14.0px STSong; font-kerning: none; color: #ed2324; -webkit-text-stroke: 0px #ed2324">任务开始之前</span><br><span style="font: 14.0px 'Times New Roman'; font-kerning: none; color: #ed2324; -webkit-text-stroke: 0px #ed2324">A</span><br><span style="font: 14.0px STSong; font-kerning: none; color: #ed2324; -webkit-text-stroke: 0px #ed2324">任务完<br>成了。那么必须把它们同时提交一个相同的队列。</span><span style="font: 14.0px STSong; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 19.0px 'Lucida Grande'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">dispatch_get_global_queue<br>方法\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">dispatch_queue_t<br>dispatch_get_global_queue(long priority,unsigned long flags);\<br>\<br> priority</span><span style="font: 13.0px Times; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">：优先级</span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">\<br>\<br> flags</span><span style="font: 13.0px Times; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">：暂时还没有用到，为0.\<br>\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">获得全局队列，根据优先级。\<br>\<br> 优先级参数取值：\<br>\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #ef8f62; -webkit-text-stroke: 0px #ef8f62">#define<br>DISPATCH_QUEUE_PRIORITY_HIGH</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #8e89f8; -webkit-text-stroke: 0px #8e89f8">2</span><span style="font: 14.0px Menlo; font-kerning: none; color: #ef8f62; -webkit-text-stroke: 0px #ef8f62">\<br> #define DISPATCH_QUEUE_PRIORITY_DEFAULT</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #8e89f8; -webkit-text-stroke: 0px #8e89f8">0</span><span style="font: 14.0px Menlo; font-kerning: none; color: #ef8f62; -webkit-text-stroke: 0px #ef8f62">\<br> #define DISPATCH_QUEUE_PRIORITY_LOW (-</span><span style="font: 14.0px Menlo; font-kerning: none; color: #8e89f8; -webkit-text-stroke: 0px #8e89f8">2</span><span style="font: 14.0px Menlo; font-kerning: none; color: #ef8f62; -webkit-text-stroke: 0px #ef8f62">)\<br> #define DISPATCH_QUEUE_PRIORITY_BACKGROUND INT16_MIN\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 19.0px 'Lucida Grande'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">dispatch_sync<br>方法\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">void<br>dispatch_sync(dispatch_queue_t queue,dispatch_block_t block);\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">queue</span><span style="font: 13.0px Times; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">：指定的队列\<br></span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">block</span><span style="font: 13.0px Times; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">：执行的代码</span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">Block\<br>\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">在指定的队列中同步执行Block。同步是指，当循环执行某个Block时，当第一个Block执行完成以后，再执行下一个Block。\<br>\<br> 例子：\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">得到默认优先级队列\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">dispatch_queue_t</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">concurrentQueue<br>=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_get_global_queue</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">DISPATCH_QUEUE_PRIORITY_DEFAULT</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">,</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">0</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">);</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_sync</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(concurrentQueue,</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #4b8186; -webkit-text-stroke: 0px #4b8186">printFrom1To1000</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">);</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">同步执行</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br>    </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_sync</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(concurrentQueue,</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #4b8186; -webkit-text-stroke: 0px #4b8186">printFrom1To1000</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">);</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">同步执行</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 12.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br>\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">同步执行的</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">Block\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">void</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(\^printFrom1To1000)(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">void</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">)<br>= \^{\<br>    </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">NSUInteger</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">counter<br>=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">0</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">;\<br>    </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">for</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(counter<br>=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">1</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">;counter<br>&lt;=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">1000</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">;counter++){\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">       </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">NSLog</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “Counter<br>= %lu - Thread = % “</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">,(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">unsigned</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">long</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">)counter,<br>[</span><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">NSThread</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">currentThread</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">]);</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32"><br>}\<br> };\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br>\<br></span><span style="font: 20.0px Times; font-kerning: none; color: #23b14b; -webkit-text-stroke: 0px #23b14b"><strong>用GCD<br>异步执行Non-UI-Related 任务</strong></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br>\<br> 异步：\<br> 在主队列、串行队列和并发队列上异步执行代码块才能见识到</span> <span style="font: 14.0px 'Times New Roman'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">GCD</span><br><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">的真正实力。你将会完全相信</span><br><span style="font: 14.0px 'Times New Roman'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">GCD</span><br><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">是多线程应用的未来,并将完全取代<br>现代应用中的线程。 \<br> 我们换一种方式讲解异步。前面代码也稍微提了一些关于异步。\<br>\<br> 一般我们异步执行，需要用的两个方法为：\<br>\<br></span><span style="font: 19.0px 'Lucida Grande'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">dispatch_async<br>方法</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 19.0px 'Lucida Grande'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">dispatch_async_f<br>方法</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br>\<br> 我们来一个综合的例子：\<br>\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">-<br>(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">void</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">)<br>viewDidAppear:(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">BOOL</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">)paramAnimated{\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">dispatch_queue_t</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">concurrentQueue<br>=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_get_global_queue</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">DISPATCH_QUEUE_PRIORITY_DEFAULT</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">,</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">0</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">);</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_async</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(concurrentQueue,<br>\^{\<br>        </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">__block</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">UIImage</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">*image<br>=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">nil</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">;\<br>        </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_sync</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(concurrentQueue,<br>\^{\<br>            </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">同步下载图片</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">           </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">NSString</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">*urlAsString<br>=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “<a href="http://images.apple.com/mobileme/features/images/ipad_findyouripad_20100518.jpg" target="_blank" rel="noopener">http://images.apple.com/mobileme/features/images/ipad_findyouripad_20100518.jpg</a>“</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">;</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">           </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">NSURL</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">*url<br>= [</span><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">NSURL</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">URLWithString</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">:urlAsString];\<br>            </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">NSURLRequest</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">*urlRequest<br>= [</span><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">NSURLRequest</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">requestWithURL</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">:url];\<br>            </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">NSError</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">*downloadError<br>=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">nil</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">;\<br>            </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">NSData</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">*imageData<br>= [</span><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">NSURLConnection</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">sendSynchronousRequest</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">:urlRequest\<br>                                                      </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">returningResponse</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">:</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">nil</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\</span></p>
<pre><code>&lt;/span&gt;
</code></pre><p><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">error</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">:&amp;downloadError];\<br>            </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">if</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(downloadError<br>==</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">nil</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">&amp;&amp;<br>imageData !=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">nil</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">){\<br>                 image = [</span><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">UIImage</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">imageWithData</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">:imageData]; \<br>             }</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">else</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">if</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(downloadError<br>!=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">nil</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">){\<br>                </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">NSLog</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “Error<br>happened = % “</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">,<br>downloadError);\<br>             }</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">else</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">{\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">               </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">NSLog</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “No<br>data could get downloaded from the URL.”</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">);<br>}</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32"><br>});\<br>         \<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">       </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_sync</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">dispatch_get_main_queue</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">(),<br>\^{</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #000000">           </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">直到下载图片完成，再调用主线程，更新</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">UI</span><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">           </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">if</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(image<br>!=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">nil</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">){\<br>                </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">UIImageView</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">*imageView<br>= [[</span><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">UIImageView</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">alloc</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">]</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">initWithFrame</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">:</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">self</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">.</span><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">view</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">.</span><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">bounds</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">];\<br>                 [imageView</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">setImage</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">:image];\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000"><br>[imageView</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">setContentMode</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">:</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">UIViewContentModeScaleAspectFit</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">];</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32"><br>[</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">self</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">.</span><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">view</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">addSubview</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">:imageView];\<br>             }</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">else</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">{\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">               </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">NSLog</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “Image<br>isn’t downloaded. Nothing to display.”</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">);</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32"><br>}\<br>         });\<br>     });\<br> }\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #ed2324; -webkit-text-stroke: 0px #ed2324"><strong>当页面显示时，用异步方式去下载图片，下载图片过程将同步执行，先下载图片数据，然后再调用主线程队列来更新UI。</strong></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br>\<br></span><span style="font: 20.0px Times; font-kerning: none; color: #23b14b; -webkit-text-stroke: 0px #23b14b"><strong>用GCD延迟执行任务</strong></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br>\</span></p>
<p>如果，我们需要某个方法在某一段时间后，执行，那么我们常常会调用这样的方法：\<br>\<br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">-<br>(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">void</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">)viewDidLoad{\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000"><br>[</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">super</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">viewDidLoad</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">];</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">    \<br>     [</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">self</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">performSelector</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">:</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d"> selector</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(printString:)\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">              </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">withObject</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">:</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “Grand<br>Central Dispatch”\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">              </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">afterDelay</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">:</span><span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">3.0</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">];\<br>     \<br> }\<br>\</span></p>
<ul>
<li>(<span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">void</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">)<br>printString:(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">NSString</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">*)paramString{\<br> </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">NSLog</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “% “</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">,<br>paramString);\<br>}\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\</span></li>
</ul>
<p>但是，我们要讲的时GCD方式。那么再GCD的世界里，也有类似的2个方法，来实现延迟执行的功能。\<br>\<br><span style="font: 19.0px 'Lucida Grande'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">dispatch_after<br>方法</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br>\<br></span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">void<br>dispatch_after(dispatch_time_t when,dispatch_queue_t<br>queue,dispatch_block_t block);\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">when</span><span style="font: 13.0px Times; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">：所指定的时间\<br></span><span style="font: 12.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">queue</span><span style="font: 13.0px Times; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">：指定的队列\<br></span><span style="font: 12.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">block</span><span style="font: 13.0px Times; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">：执行的</span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">Block\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br> 将Block加入指定队列，并按照指定时间执行。\<br>\<br> 先上例子：\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">-<br>(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">void</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">)viewDidLoad{\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000"><br>[</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">super</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">viewDidLoad</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">];</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">    \<br>    </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">double</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">delayInSeconds<br>=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">2.0</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">;\<br>     \<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">创建延期的时间</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">2S</span><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">，因为</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">dispatch_time</span><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">使用的时间是纳秒，尼玛，比毫秒还小，太夸张了！！！\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">dispatch_time_t</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">delayInNanoSeconds<br>=</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_time</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">DISPATCH_TIME_NOW</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">,<br>delayInSeconds *</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">NSEC_PER_SEC</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">);\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">得到全局队列</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">dispatch_queue_t</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">concurrentQueue<br>=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_get_global_queue</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">DISPATCH_QUEUE_PRIORITY_DEFAULT</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">,</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">0</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">);</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">延期执行</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_after</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(delayInNanoSeconds,<br>concurrentQueue, \^(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">void</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">){\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">       </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">NSLog</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “Output<br>GCD !”</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">);</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">        \<br>     });\<br>     \<br> }\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 19.0px 'Lucida Grande'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">dispatch_time</span><br><span style="font: 19.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">方法</span><span style="font: 19.0px 'Lucida Grande'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">dispatch_time_t<br>dispatch_time(dispatch_time_t when,int64_t delta);\<br>\<br> when</span><span style="font: 13.0px Times; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">：指定的开始点，可以用</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">DISPATCH_TIME_NOW</span><br><span style="font: 13.0px Times; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">来指定一个当前的时间点\<br>\<br></span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">delta</span><span style="font: 13.0px Times; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">：纳秒数 </span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br> 创建一个时间点（</span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">dispatch_time_t</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">），返回的时间点为：</span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">delta+<br>when</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br>\<br>\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">dispatch_time_t：</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">纯粹就是一个时间点。\<br>\<br></span><span style="font: 19.0px 'Lucida Grande'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">dispatch_after</span><br><span style="font: 19.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">方法</span><span style="font: 19.0px 'Lucida Grande'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 12.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">void<br>dispatch_after(dispatch_time_t when,dispatch_queue_t<br>queue,dispatch_block_t block);\<br></span><span style="font: 12.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">when</span><span style="font: 13.0px Times; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">：时间点\<br></span><span style="font: 12.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">queue</span><span style="font: 13.0px Times; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">：指定的队列\<br></span><span style="font: 12.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">block</span><span style="font: 13.0px Times; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">：执行的</span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">Block\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br> 将Block加入到指定的队列，并且在指定的时间点执行。\<br>\<br></span><span style="font: 16.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">dispatch_after_f<br>方法</span><span style="font: 19.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br> 我想有了，前面知识的铺垫，这个方法理解起来，就像在切菜！！！\<br>\<br> 直接上例子：\<br>\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">-<br>(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">void</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">)viewDidLoad{\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000"><br>[</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">super</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">viewDidLoad</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">];</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">    \<br>    </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">double</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">delayInSeconds<br>=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">2.0</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">;\<br>    </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">dispatch_time_t</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">delayInNanoSeconds<br>=</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_time</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">DISPATCH_TIME_NOW</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">,<br>delayInSeconds *</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">NSEC_PER_SEC</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">);\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">dispatch_queue_t</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">concurrentQueue<br>=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_get_global_queue</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">DISPATCH_QUEUE_PRIORITY_DEFAULT</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">,</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">0</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">);</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">    \<br>    </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_after_f</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(delayInNanoSeconds,concurrentQueue,</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “GCD”</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">,</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #2e595d; -webkit-text-stroke: 0px #2e595d">processSomething</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">);\<br>\<br> }\<br>\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">void</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">processSomething(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">void</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">*paramContext){\<br>     \<br>    </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">NSLog</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “This<br>is % “</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">,paramContext);\<br> }\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br> 注意：</span><span style="font: 14.0px Times; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_after_f </span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">执行的是一个纯C函数（</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">processSomething</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">）！\<br>\<br></span><span style="font: 20.0px Times; font-kerning: none; color: #23b14b; -webkit-text-stroke: 0px #23b14b"><strong>使用GCD来实现单例模式</strong></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 16.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">在</span><br><span style="font: 14.0px 'Times New Roman'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">APP</span><br><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">的生命周期内你想确保每段代码只执行一次,即使它在代码的不同地方多次调用(比如单例的初始化)。 \<br>\<br> 直接代码：\<br>\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">static</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">dispatch_once_t</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #000000">onceToken;</span><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">void</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(\^executedOnlyOnce)(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">void</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">)<br>= \^{\<br>    </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">static</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">NSUInteger</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">numberOfEntries<br>=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">0</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">;\<br>     numberOfEntries++;\<br>    </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">NSLog</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “Executed<br>%lu time(s)”</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">,<br>(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">unsigned</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">long</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">)numberOfEntries);\<br> };\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br> 调用：\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">dispatch_queue_t</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">concurrentQueue<br>=</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_get_global_queue</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">DISPATCH_QUEUE_PRIORITY_DEFAULT</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">,</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">0</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">);</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">    \<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">dispatch_once</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">(&amp;</span><span style="font: 14.0px Menlo; font-kerning: none; color: #4b8186; -webkit-text-stroke: 0px #4b8186">onceToken</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">,<br>\^{</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">       </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_async</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(concurrentQueue,</span><span style="font: 14.0px Menlo; font-kerning: none; color: #4b8186; -webkit-text-stroke: 0px #4b8186">executedOnlyOnce</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">);\<br>     });\<br>\<br>     \<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">dispatch_once</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">(&amp;</span><span style="font: 14.0px Menlo; font-kerning: none; color: #4b8186; -webkit-text-stroke: 0px #4b8186">onceToken</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">,<br>\^{</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">       </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_async</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(concurrentQueue,</span><span style="font: 14.0px Menlo; font-kerning: none; color: #4b8186; -webkit-text-stroke: 0px #4b8186">executedOnlyOnce</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">);\<br>     });\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br> 可以发现，输出只有一行，虽然我们调用了2次。因为我们传入的</span><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">dispatch_once_t</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">是相同的。编译器只执行一次操作。\<br>\<br></span><span style="font: 19.0px 'Lucida Grande'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">dispatch_once</span><br><span style="font: 19.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">方法</span><span style="font: 19.0px 'Lucida Grande'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">void<br>dispatch_once(dispatch_once_t *predicate,dispatch_block_t block);\<br>\<br> predicate</span><span style="font: 13.0px Times; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">：单例标识符</span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">\<br> block</span><span style="font: 13.0px Times; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">：执行的</span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">Block</span><span style="font: 19.0px 'Lucida Grande'; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #000000"> </span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br> 在Application周期内，只执行一次Block。即：单例模式\<br>\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">dispatch_once_t</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">：可以理解为单例标识符，</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">dispatch_once</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">方法用它来测试Block是否被执行过了。如果执行过了，那么就不在执行。\<br>\<br></span><span style="font: 20.0px Times; font-kerning: none; color: #23b14b; -webkit-text-stroke: 0px #23b14b"><strong>用<br>GCD</strong> <strong>将任务分组  </strong></span> <span style="font: 21.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32"> </span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br>\</span></p>
<p>有时候，我们可能执行一系列的任务。由于彼此之间的依赖关系。比如有3个任务：A、B、C；我们必须执行了任务A，才能执行任务B，最后执行任务C。这样的话，我们可以用GCD的分组机制来将多个任务来按照预定的顺序来执行。\<br>\<br>\<br> 先看例子吧：\<br>\<br>\<br>\<br> 我们先来搞清楚以下的关于调度组的一些常用方法\<br><span style="font: 16.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 19.0px 'Lucida Grande'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">dispatch_group_t</span><br><span style="font: 19.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">方法</span><span style="font: 19.0px 'Lucida Grande'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 12.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">typedef<br>struct dispatch_group_s *dispatch_group_t;\<br>\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666"> \<br></span><span style="font: 14.0px Courier; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #000000">指代一个调度组。</span><span style="font: 14.0px Courier; font-kerning: none; -webkit-text-stroke: 0px #000000">\<br></span><span style="font: 14.0px Courier; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #000000">调度组负责监视加入到该组的多个Block。每个Block可以是异步或者同步（取决与你自己）。</span><span style="font: 14.0px Courier; font-kerning: none; -webkit-text-stroke: 0px #000000">\<br></span><span style="font: 14.0px Courier; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #000000">调度组中的Block可以在不同的队列中执行；并且一个Block可以被添加到多个调度组中。</span><span style="font: 14.0px Courier; font-kerning: none; -webkit-text-stroke: 0px #000000">\<br>\<br></span><span style="font: 19.0px 'Lucida Grande'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #000000">dispatch_group_create</span><br><span style="font: 19.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #000000">方法</span><span style="font: 19.0px 'Lucida Grande'; font-kerning: none; -webkit-text-stroke: 0px #000000">\<br></span><span style="font: 12.0px Times; font-kerning: none; -webkit-text-stroke: 0px #000000">\<br></span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">dispatch_group_t<br>dispatch_group_create(void);\<br></span><span style="font: 12.0px Times; font-kerning: none; -webkit-text-stroke: 0px #000000">\<br></span><span style="font: 14.0px Courier; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #000000">创建一个调度组</span><span style="font: 14.0px Times; font-kerning: none; -webkit-text-stroke: 0px #000000">\<br></span><span style="font: 14.0px Courier; font-kerning: none; -webkit-text-stroke: 0px #000000">\<br></span><span style="font: 19.0px 'Lucida Grande'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #000000">dispatch_group_async</span><br><span style="font: 19.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #000000">方法</span><span style="font: 19.0px 'Lucida Grande'; font-kerning: none; -webkit-text-stroke: 0px #000000">\<br></span><span style="font: 12.0px Times; font-kerning: none; -webkit-text-stroke: 0px #000000">\<br></span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">void<br>dispatch_group_async(dispatch_group_t group,dispatch_queue_t<br>queue,dispatch_block_t block);\<br></span><span style="font: 12.0px Times; font-kerning: none; -webkit-text-stroke: 0px #000000">\<br></span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">group</span><span style="font: 13.0px Times; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">：要分发到的调度组\<br>\<br></span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">queue</span><span style="font: 13.0px Times; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">：执行</span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">Block</span><span style="font: 13.0px Times; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">的队列</span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">\<br>\<br> block</span><span style="font: 13.0px Times; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">：要执行的</span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">Block\<br></span><span style="font: 12.0px Times; font-kerning: none; -webkit-text-stroke: 0px #000000">\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #000000">将Block分发到指定的队列（用指定的队列来执行Block），并且将该Block加入到指定的调度组中。</span><span style="font: 14.0px Times; font-kerning: none; -webkit-text-stroke: 0px #000000">\<br></span><span style="font: 12.0px Times; font-kerning: none; -webkit-text-stroke: 0px #000000">\<br></span><span style="font: 19.0px 'Lucida Grande'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #000000">dispatch_group_notify</span><br><span style="font: 19.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #000000">方法</span><span style="font: 19.0px 'Lucida Grande'; font-kerning: none; -webkit-text-stroke: 0px #000000">\<br>\<br></span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">void<br>dispatch_group_notify(dispatch_group_t group,dispatch_queue_t<br>queue,dispatch_block_t block);\<br>\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #000000">当调度组中的所有Block被执行完成后，将调用被分配到指定队列的Block。</span><span style="font: 14.0px Times; font-kerning: none; -webkit-text-stroke: 0px #000000">\<br></span><span style="font: 12.0px Times; font-kerning: none; -webkit-text-stroke: 0px #000000">\<br></span><span style="font: 19.0px 'Lucida Grande'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #000000">dispatch_release</span><br><span style="font: 19.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #000000">方法</span><span style="font: 19.0px 'Lucida Grande'; font-kerning: none; -webkit-text-stroke: 0px #000000">\<br></span><span style="font: 12.0px Times; font-kerning: none; -webkit-text-stroke: 0px #000000">\<br></span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">void<br>dispatch_release(dispatch_object_t object);\<br></span><span style="font: 12.0px Times; font-kerning: none; -webkit-text-stroke: 0px #000000">\<br></span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">object</span><span style="font: 13.0px Times; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">：调度对象</span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">\<br></span><span style="font: 12.0px Times; font-kerning: none; -webkit-text-stroke: 0px #000000">\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #000000">销毁指定的调度组。</span><span style="font: 14.0px Times; font-kerning: none; -webkit-text-stroke: 0px #000000">\<br></span><span style="font: 14.0px Courier; font-kerning: none; -webkit-text-stroke: 0px #000000">\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">理论一大堆了，还是用事实来说话：\<br></span><span style="font: 16.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br> 例子：</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 16.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">-<br>(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">void</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">)viewDidAppear:(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">BOOL</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">)animated{\<br>     \<br>     [</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">super</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">viewDidAppear</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">:animated];\<br>     \<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">dispatch_group_t</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">taskGroup<br>=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_group_create</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">();</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">创建一个调度组</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">dispatch_queue_t</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">mainQueue<br>=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">dispatch_get_main_queue</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">();</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">创建队列</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">    \<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">任务</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">1\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">将</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">Block</span><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">添加到指定的调度组</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">(taskGroup)</span><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">中，并且该</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">Block</span><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">用指定的队列</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">(mainQueue)</span><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">执行。</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_group_async</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(taskGroup,<br>mainQueue, \^{\<br>         \<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #2e595d; -webkit-text-stroke: 0px #000000"><br>[</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">self</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #2e595d; -webkit-text-stroke: 0px #2e595d">reloadTableView</span><span style="font: 14.0px Menlo; font-kerning: none; color: #2e595d; -webkit-text-stroke: 0px #000000">];</span><span style="font: 14.0px Menlo; font-kerning: none; color: #2e595d; -webkit-text-stroke: 0px #2e595d">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32"><br>});\<br>     \<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">任务</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">2\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">将</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">Block</span><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">添加到指定的调度组</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">(taskGroup)</span><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">中，并且该</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">Block</span><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">用指定的队列</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">(mainQueue)</span><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">执行。</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_group_async</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(taskGroup,<br>mainQueue, \^{\<br>         \<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #2e595d; -webkit-text-stroke: 0px #000000"><br>[</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">self</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #2e595d; -webkit-text-stroke: 0px #2e595d">reloadScrollView</span><span style="font: 14.0px Menlo; font-kerning: none; color: #2e595d; -webkit-text-stroke: 0px #000000">];</span><span style="font: 14.0px Menlo; font-kerning: none; color: #2e595d; -webkit-text-stroke: 0px #2e595d">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32"><br>});\<br>     \<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">任务</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">3\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">将</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">Block</span><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">添加到指定的调度组</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">(taskGroup)</span><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">中，并且该</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">Block</span><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">用指定的队列</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">(mainQueue)</span><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">执行。</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_group_async</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(taskGroup,<br>mainQueue, \^{\<br>         \<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #2e595d; -webkit-text-stroke: 0px #000000"><br>[</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">self</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #2e595d; -webkit-text-stroke: 0px #2e595d">reloadImageView</span><span style="font: 14.0px Menlo; font-kerning: none; color: #2e595d; -webkit-text-stroke: 0px #000000">];</span><span style="font: 14.0px Menlo; font-kerning: none; color: #2e595d; -webkit-text-stroke: 0px #2e595d">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32"><br>});\<br>     \<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">当指定调度组（</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">taskGroup</span><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">）中的所有</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">Block</span><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">都执行完成后，将执行给定的</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">Block</span><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">，用指定的队列（</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">mainQueue</span><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">）。</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_group_notify</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(taskGroup,<br>mainQueue, \^{\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #000000">       </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">指定的</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">Block\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000"><br>[[[</span><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">UIAlertView</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">alloc</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">]</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">initWithTitle</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">:</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “Finished”</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">                                   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">message</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">:</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “All<br>tasks are finished”</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">delegate</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">:</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">nil</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">                         </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">cancelButtonTitle</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">:</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “OK”</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">otherButtonTitles</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">:</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">nil</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">,</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">nil</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">]</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">show</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">];</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">        \<br>     });\<br>     \<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">最后，必须</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">release</span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">掉调度组（</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">taskGroup</span><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">）</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_release</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(taskGroup);\<br>\<br> }</span><span style="font: 16.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32"> </span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br>\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">#pragma<br>mark -</span> <span style="font: 14.0px Times; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">执行的多个方法</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\</span></p>
<ul>
<li>(<span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">void</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">)<br>reloadTableView{\<br>  \<br>  NSLog(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “%s”</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">,</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">__FUNCTION__</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">);\<br>}\<br>\</span></li>
<li>(<span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">void</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">)<br>reloadScrollView{\<br>\<br>  NSLog(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “%s”</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">,</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">__FUNCTION__</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">);\<br>}\<br>\</span></li>
<li>(<span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">void</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">)<br>reloadImageView{\<br>\<br>  NSLog(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “%s”</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">,</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">__FUNCTION__</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">);\<br>  \<br>}\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br>执行结果：\<br>\<br></span><span style="font: 11.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32"><strong>2013-03-28<br>23:00:57.394 DemoVideo[25096:707] -[MoreViewController<br>reloadTableView]</strong>\<br><strong>2013-03-28 23:00:57.395 DemoVideo[25096:707] -[MoreViewController<br>reloadScrollView]</strong>\<br><strong>2013-03-28 23:00:57.396 DemoVideo[25096:707] -[MoreViewController<br>reloadImageView]</strong>\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br>可见，执行顺序，跟加入到调度组中的次序是一样的。\<br>\<br>等等，有点疑惑是不是？！\<br>我对每个任务用的是方法</span><span style="font: 14.0px Times; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_group_async</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">，是异步的啊。为什么顺序却不变呢？！\<br>呵呵，基础不扎实啊！因为他们都是分配给同一个队列</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">dispatch_get_main_queue</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">()<br>中的！在一个队列中是串行的啊。所以，还是按照顺序来。\<br>\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #ed2324; -webkit-text-stroke: 0px #ed2324"><strong>对，在GCD中，每个方法往往都有两种，一种是执行标准Block，一种是执行C函数的。</strong></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br>\<br>那么，就ok，我们来看看执行C函数的写法：\<br>\<br>例子：\<br>\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">-<br>(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">void</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">)viewDidAppear:(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">BOOL</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">)animated{\<br>  \<br>  [</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">super</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">viewDidAppear</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">:animated];\<br>  \<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">dispatch_group_t</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">taskGroup<br>=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_group_create</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">();</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">dispatch_queue_t</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">mainQueue<br>=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">dispatch_get_main_queue</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">();</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_group_async_f</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(taskGroup,<br>mainQueue,(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">void</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">*)</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">self</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">,</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #2e595d; -webkit-text-stroke: 0px #2e595d">reloadAllComponents</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">);\<br>  \<br>  dispatch_group_notify(taskGroup, mainQueue, \^{\<pre><code>\
</code></pre></span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000"><br>[[[</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">UIAlertView</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">alloc]</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">initWithTitle</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">:</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “Finished”</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32"><br>message:</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “All<br>Tasks are Finished”</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<pre><code>delegate:&lt;/span&gt;&lt;span
</code></pre>style=”font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d”&gt;nil</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<pre><code>&lt;/span&gt; &lt;span
</code></pre>style=”font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c”&gt;cancelButtonTitle</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">:</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “OK”</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">otherButtonTitles:</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">nil</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">,</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">nil</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">]<br>show];\<pre><code>});\
</code></pre>  \<br>  dispatch_release(taskGroup);\<pre><code>\
</code></pre>\<br>}\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">定义调度组要执行的</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">C</span><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">函数\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">void</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">reloadAllComponents(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">void</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">*</span><span style="font: 14.0px Menlo; font-kerning: none; color: #4b8186; -webkit-text-stroke: 0px #4b8186">context</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">){\<br> </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #2e595d; -webkit-text-stroke: 0px #2e595d">MoreViewController</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">*</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">self</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">=(MoreViewController<br>*)context;\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #2e595d; -webkit-text-stroke: 0px #000000"><br>[</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">self</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #2e595d; -webkit-text-stroke: 0px #2e595d">reloadTableView</span><span style="font: 14.0px Menlo; font-kerning: none; color: #2e595d; -webkit-text-stroke: 0px #000000">];</span><span style="font: 14.0px Menlo; font-kerning: none; color: #2e595d; -webkit-text-stroke: 0px #2e595d">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #2e595d; -webkit-text-stroke: 0px #000000"><br>[</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">self</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #2e595d; -webkit-text-stroke: 0px #2e595d">reloadScrollView</span><span style="font: 14.0px Menlo; font-kerning: none; color: #2e595d; -webkit-text-stroke: 0px #000000">];</span><span style="font: 14.0px Menlo; font-kerning: none; color: #2e595d; -webkit-text-stroke: 0px #2e595d">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32"><br>[</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">self</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">reloadImageView];\<br>}\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #ed2324; -webkit-text-stroke: 0px #ed2324"><strong>注意：</strong></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br>因为</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_group_async_f</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">不像</span><span style="font: 14.0px Times; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">dispatch_group_t</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">那样使用Block，可以访问当前类的变量。\<br>\<br>由于 </span><span style="font: 14.0px 'Times New Roman'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">dispatch_group_async_f </span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">接受 </span><span style="font: 14.0px 'Times New Roman'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">C </span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">函数作为一个代码块来执行,所以，我们要执行</span><span style="font: 14.0px Menlo; font-kerning: none; color: #2e595d; -webkit-text-stroke: 0px #2e595d">reloadTableView</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">方法，</span><span style="font: 14.0px Menlo; font-kerning: none; color: #2e595d; -webkit-text-stroke: 0px #2e595d">reloadScrollView</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">方法，</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">reloadImageView方法，必须有个当前类的引用！！！！！</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br>那么</span> <span style="font: 14.0px 'Times New Roman'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">C</span><br><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">函数必须有一<br>个引用到</span> <span style="font: 14.0px 'Times New Roman'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">Self,这个<br>Self</span> <span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">能够调用当前对象的实例方法 \<br>\<br></span><span style="font: 20.0px Times; font-kerning: none; color: #23b14b; -webkit-text-stroke: 0px #23b14b"><strong>用<br>GCD</strong> <strong>创建自己的分发队列 </strong></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32"> </span><span style="font: 21.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32"> </span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br>\</span></li>
</ul>
<p>当然，GCD也给予了我们很多自主性质的操作。就是可以定义我们自己的分发队列。\<br>\</p>
<p>有时候，突发奇想，自己定义一个队列，做自己的事情！那该多自由！这一定可以有的，哟，亲！！\<br> 爽啊！！！\<br>\<br><span style="font: 14.0px Times; font-kerning: none; color: #ed2324; -webkit-text-stroke: 0px #ed2324"><strong>注意：我们自定义的队列，往往不会在主队列中执行。而是单独分配一个线程来维护我们所定义的队列。</strong></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br>\<br> 先来看代码吧：\<br>\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">-<br>(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">void</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">)viewDidAppear:(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">BOOL</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">)animated{\<br>     \<br>     [</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">super</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">viewDidAppear</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">:animated];\<br>     \<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">创建指定的自定义的串行队列\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">dispatch_queue_t</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">firstSerialQueue<br>=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_queue_create</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24">“com.pixolity.GCD.serialQueue1”</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">,</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">NULL</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">);</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">    \<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">让队列异步执行</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">Block\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_async</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(firstSerialQueue,<br>\^{\<br>        </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">NSUInteger</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">counter<br>=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">0</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">;\<br>        </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">for</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(counter<br>=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">0</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">;<br>counter &lt;</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">5</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">;<br>counter++){\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">           </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">NSLog</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “First<br>iteration, counter = %lu”</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">,<br>(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">unsigned</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">long</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">)counter);<br>}</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">           </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">NSLog</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “Current<br>thread = % “</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">,<br>[</span><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">NSThread</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">currentThread</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">]);</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32"><br>});\<br>     \<br>    </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_async</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(firstSerialQueue,<br>\^{\<br>        </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">NSUInteger</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">counter<br>=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">0</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">;</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">for</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(counter<br>=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">0</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">;counter<br>&lt;</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">5</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">;counter++){\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">           </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">NSLog</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “Second<br>iteration, counter = %lu”</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">,<br>(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">unsigned</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">long</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">)counter);</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">           </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">NSLog</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “Current<br>thread = % “</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">,<br>[</span><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">NSThread</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">currentThread</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">]);</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32"><br>}\<br>     });\<br>     \<br>    </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_async</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(firstSerialQueue,<br>\^{</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">NSUInteger</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">counter<br>=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">0</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">;\<br>        </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">for</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(counter<br>=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">0</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">;counter<br>&lt;</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">5</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">;counter++){\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">           </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">NSLog</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “Third<br>iteration, counter = %lu”</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">,<br>(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">unsigned</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">long</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">)counter);</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">           </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">NSLog</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “Current<br>thread = % “</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">,<br>[</span><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">NSThread</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">currentThread</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">]);</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32"><br>}\<br>     });\<br>     \<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">销毁队列</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_release</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(firstSerialQueue);\<br>     \<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">输出主队列，比较会发现，我们自定义的队列，并不在主线程上，效率还是蛮高的。\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">dispatch_queue_t</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">mainQueue1<br>=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">dispatch_get_main_queue</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #000000">();</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_async</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(mainQueue1,<br>\^(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">void</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">)<br>{\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">       </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">NSLog</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “Main<br>thread = % “</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">,<br>[</span><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">NSThread</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">mainThread</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">]);</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32"><br>});\<br>         \<br>\<br> }\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br> 代码，不解释！\<br>\<br> 对，上面是Block形式的。还有一个C函数的自定义吧！\<br>\<br> 贴，贴更健康！\<br>\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">定义任务</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">1-C</span><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">函数形式\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">void</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">firstIteration(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">void</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">*paramContext){\<br>    </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">NSUInteger</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">counter<br>=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">0</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">;\<br>    </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">for</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(counter<br>=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">0</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">;counter<br>&lt;</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">5</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">;counter++){\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">       </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">NSLog</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “First<br>iteration, counter = %lu”</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">,<br>(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">unsigned</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">long</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">)counter);</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32"><br>}\<br> }\<br>\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">定义任务</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">2-C</span><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">函数形式\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">void</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">secondIteration(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">void</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">*paramContext){\<br>    </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">NSUInteger</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">counter<br>=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">0</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">;\<br>    </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">for</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(counter<br>=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">0</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">;counter<br>&lt;</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">5</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">;counter++){\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">       </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">NSLog</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “Second<br>iteration, counter = %lu”</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">,<br>(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">unsigned</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">long</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">)counter);</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32"><br>}\<br> }\<br>\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><br><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">定义任务</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">3-C</span><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">函数形式\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">void</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">thirdIteration(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">void</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">*paramContext){\<br>    </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">NSUInteger</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">counter<br>=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">0</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">;\<br>    </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">for</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(counter<br>=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">0</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">;counter<br>&lt;</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">5</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">;counter++){\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">       </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">NSLog</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “Third<br>iteration, counter = %lu”</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">,<br>(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">unsigned</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">long</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">)counter);</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32"><br>}\<br> }\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">-<br>(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">void</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">)viewDidAppear:(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">BOOL</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">)animated{\<br>     \<br>     [</span><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">super</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">viewDidAppear</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">:animated];\<br>     \<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">dispatch_queue_t</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">firstSerialQueue<br>=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_queue_create</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24">“com.pixolity.GCD.serialQueue1”</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">,</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">0</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #000000">);</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_async_f</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(firstSerialQueue,</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">NULL</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">,</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #2e595d; -webkit-text-stroke: 0px #2e595d">firstIteration</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">);\<br>    </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_async_f</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(firstSerialQueue,</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">NULL</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">,</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #2e595d; -webkit-text-stroke: 0px #2e595d">secondIteration</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">);\<br>    </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_async_f</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(firstSerialQueue,</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">NULL</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">,</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #2e595d; -webkit-text-stroke: 0px #2e595d">thirdIteration</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">);\<br>    </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_release</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(firstSerialQueue);\<br>         \<br>\<br> }\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 20.0px Times; font-kerning: none; color: #23b14b; -webkit-text-stroke: 0px #23b14b"><strong>用<br>GCD</strong> <strong>进行信号量的管理操作</strong></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br>\<br></span><span style="font: 19.0px 'Lucida Grande'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">dispatch_semaphore_create</span><br><span style="font: 19.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">方法</span><span style="font: 19.0px 'Lucida Grande'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">dispatch_semaphore_t<br>dispatch_semaphore_create(long value);\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">创建一个信号量对象\<br>\<br></span><span style="font: 13.0px 'Lucida Grande'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">value</span><span style="font: 13.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">：信号量的值，必须大于等于</span><span style="font: 13.0px 'Lucida Grande'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">0</span><span style="font: 13.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">。\<br></span><span style="font: 13.0px 'Lucida Grande'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #23b14b; -webkit-text-stroke: 0px #23b14b"><strong>什么是信号量？</strong></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 13.0px 'Lucida Grande'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 13.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">我想举个例子你就会明白了。古时候执行某种命令需要令牌。创建一个信号量，就是创建一个命令。\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">dispatch_semaphore_t</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">semaphore<br>=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_semaphore_create</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">3</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">);</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">也就是说，一项任务</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">semaphore</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">，有3个令牌，就是说，最多可以同时分派3名不同的将领去执行。\<br>\<br>\<br></span><span style="font: 19.0px 'Lucida Grande'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">dispatch_semaphore_wait\<br></span><span style="font: 13.0px 'Lucida Grande'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">Waits<br>for (decrements) a semaphore.\<br></span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">long<br>dispatch_semaphore_wait(dispatch_semaphore_t dsema,dispatch_time_t<br>timeout);\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">递减信号量。\<br></span><span style="font: 14.0px 'Lucida Grande'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">dsema</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">：信号量</span><span style="font: 14.0px 'Lucida Grande'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br>\<br> timeout</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">：等待信号量的策略\<br> 返回</span><span style="font: 14.0px 'Lucida Grande'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">0</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">，说明递减信号量成功。\</span></p>
<p>也就是说，拿走一个令牌去执行某个任务。这时候，令牌数量会减去1。当令牌用完时，使用FIFO的原则进行等待。\<br>\<br><span style="font: 19.0px 'Lucida Grande'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">dispatch_semaphore_signal\<br></span><span style="font: 13.0px 'Lucida Grande'; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br></span><span style="font: 13.0px Courier; font-kerning: none; color: #666666; -webkit-text-stroke: 0px #666666">long<br>dispatch_semaphore_signal(dispatch_semaphore_t dsema);\<br></span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">增加信号量\</span></p>
<p>也就是说，某一个将领执行任务回来。并且将令牌上交。这样处于等待中的将领可以得到令牌并执行相应任务<span style="font: 13.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">。</span><span style="font: 14.0px Times; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">\<br>\<br> 例子：\<br> 使用信号量实现锁操作。\<br>\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">主线程中\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #4b8186; -webkit-text-stroke: 0px #4b8186">TestObj</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">*obj<br>= [[</span><span style="font: 14.0px Menlo; font-kerning: none; color: #4b8186; -webkit-text-stroke: 0px #4b8186">TestObj</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">alloc</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">]</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">init</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">];\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #743fa4; -webkit-text-stroke: 0px #743fa4">dispatch_semaphore_t</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">semaphore<br>=</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_semaphore_create</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">1</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">);</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">    \<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">线程</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">1\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_async</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_get_global_queue</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">DISPATCH_QUEUE_PRIORITY_DEFAULT</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">,</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">0</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">),<br>\^{</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">       </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">long</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">thecount=</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_semaphore_wait</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(semaphore,</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">DISPATCH_TIME_FOREVER</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">);\<br>        </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">NSLog</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “%ld”</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">,thecount);\<br>         [obj</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #2e595d; -webkit-text-stroke: 0px #2e595d">method1</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">];\<br>        </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">sleep</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">10</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">);\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">       </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_semaphore_signal</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">(semaphore);</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32"><br>});\<br>     \<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">//</span><span style="font: 14.0px Times; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">线程</span><span style="font: 14.0px Menlo; font-kerning: none; color: #008324; -webkit-text-stroke: 0px #008324">2\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">   </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_async</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_get_global_queue</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">DISPATCH_QUEUE_PRIORITY_DEFAULT</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">,</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">0</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">),<br>\^{</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">       </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">sleep</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #2f2fd0; -webkit-text-stroke: 0px #2f2fd0">1</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">);\<br>        </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #c02d9d; -webkit-text-stroke: 0px #c02d9d">long</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">thecount=</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_semaphore_wait</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(semaphore,</span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #7a4830; -webkit-text-stroke: 0px #7a4830">DISPATCH_TIME_FOREVER</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">);\<br>        </span> <span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">NSLog</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">(</span><span style="font: 14.0px Menlo; font-kerning: none; color: #d62c24; -webkit-text-stroke: 0px #d62c24"> “—-%ld”</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">,thecount);\<br>\<br>         [obj</span> <span style="font: 14.0px Menlo; font-kerning: none; color: #2e595d; -webkit-text-stroke: 0px #2e595d">method2</span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32">];\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">       </span><br><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">dispatch_semaphore_signal</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #000000">(semaphore);</span><span style="font: 14.0px Menlo; font-kerning: none; color: #40207c; -webkit-text-stroke: 0px #40207c">\<br></span><span style="font: 14.0px Menlo; font-kerning: none; color: #323e32; -webkit-text-stroke: 0px #323e32"><br>});</span></p>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/专业技术-印象笔记/">专业技术(印象笔记)</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/从印象笔记导入/">从印象笔记导入</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="http://www.huguiqi.top/2020/04/29/GCD（Grand Central Dispatch）和Block 使用-浅析/" data-title="GCD（Grand Central Dispatch）和Block 使用-浅析 | 小黑的技术博客" data-tsina="1601653200" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2020/04/29/HOW TO INSTALL MYSQL 5.6 ON CENTOS 6.3_REDHAT EL6_FEDORA/" title="HOW TO INSTALL MYSQL 5.6 ON CENTOS 6.3_REDHAT EL6_FEDORA">
  <strong>上一篇：</strong><br/>
  <span>
  HOW TO INSTALL MYSQL 5.6 ON CENTOS 6.3_REDHAT EL6_FEDORA</span>
</a>
</div>


<div class="next">
<a href="/2020/04/29/GCD 深入理解（二）/"  title="GCD 深入理解（二）">
 <strong>下一篇：</strong><br/> 
 <span>GCD 深入理解（二）
</span>
</a>
</div>

</nav>

	
<section id="comments" class="comment">
	<div class="ds-thread" data-thread-key="2020/04/29/GCD（Grand Central Dispatch）和Block 使用-浅析/" data-title="GCD（Grand Central Dispatch）和Block 使用-浅析" data-url="http://www.huguiqi.top/2020/04/29/GCD（Grand Central Dispatch）和Block 使用-浅析/"></div>
</section>


<section id="comments" class="comment">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>

</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
 
 <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#GCD（Grand-Central-Dispatch）和Block-使用-浅析"><span class="toc-number">1.</span> <span class="toc-text">GCD（Grand Central Dispatch）和Block 使用-浅析</span></a></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  
<div class="github-card">
<p class="asidetitle">Github 名片</p>
<div class="github-card" data-github="huguiqi" data-width="220" data-height="119" data-theme="medium">
<script type="text/javascript" src="//cdn.jsdelivr.net/github-cards/latest/widget.js" ></script>
</div>
  </div>



  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
		  
			<li><a href="/categories/AFNetWork3-1/" title="AFNetWork3.1">AFNetWork3.1<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Alcatraz/" title="Alcatraz">Alcatraz<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/IT-运维/" title="IT&amp;运维">IT&amp;运维<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/activiti/" title="activiti">activiti<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/docker/" title="docker">docker<sup>5</sup></a></li>
		  
		
		  
			<li><a href="/categories/git/" title="git">git<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/github-博客/" title="github 博客">github 博客<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/hexo/" title="hexo">hexo<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/hexo插件/" title="hexo插件">hexo插件<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/iOS/" title="iOS">iOS<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/ios-Developer/" title="ios Developer">ios Developer<sup>5</sup></a></li>
		  
		
		  
			<li><a href="/categories/java/" title="java">java<sup>11</sup></a></li>
		  
		
		  
			<li><a href="/categories/javascript/" title="javascript">javascript<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/node/" title="node">node<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/nodejs/" title="nodejs">nodejs<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/python/" title="python">python<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/redis/" title="redis">redis<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/springCloud/" title="springCloud">springCloud<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/springboot/" title="springboot">springboot<sup>5</sup></a></li>
		  
		
		  
			<li><a href="/categories/activiti/springboot/" title="springboot">springboot<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/springcloud/" title="springcloud">springcloud<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/xcode/" title="xcode">xcode<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/专业技术-印象笔记/" title="专业技术(印象笔记)">专业技术(印象笔记)<sup>222</sup></a></li>
		  
		
		  
			<li><a href="/categories/前端技术/" title="前端技术">前端技术<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/大数据/" title="大数据">大数据<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/感悟/" title="感悟">感悟<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/杂谈/" title="杂谈">杂谈<sup>7</sup></a></li>
		  
		
		  
			<li><a href="/categories/科学上网/" title="科学上网">科学上网<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/站内搜索-博客/" title="站内搜索 博客">站内搜索 博客<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/管理/" title="管理">管理<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/系统/" title="系统">系统<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/系统-工具/" title="系统&amp;工具">系统&amp;工具<sup>6</sup></a></li>
		  
		
		  
			<li><a href="/categories/系统-运维/" title="系统&amp;运维">系统&amp;运维<sup>18</sup></a></li>
		  
		
		  
			<li><a href="/categories/网络配置/" title="网络配置">网络配置<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/读书笔记/" title="读书笔记">读书笔记<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/随笔/" title="随笔">随笔<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/面试整理/" title="面试整理">面试整理<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/面试题/" title="面试题">面试题<sup>1</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/从印象笔记导入/" title="从印象笔记导入">从印象笔记导入<sup>222</sup></a></li>
			
		
			
				<li><a href="/tags/随笔/" title="随笔">随笔<sup>8</sup></a></li>
			
		
			
				<li><a href="/tags/docker/" title="docker">docker<sup>7</sup></a></li>
			
		
			
				<li><a href="/tags/springboot/" title="springboot">springboot<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/面试题/" title="面试题">面试题<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/hexo/" title="hexo">hexo<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/Rejected/" title="Rejected">Rejected<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/nginx/" title="nginx">nginx<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/ReactNative/" title="ReactNative">ReactNative<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/spring-cloud/" title="spring cloud">spring cloud<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/javascript-原型编程/" title="javascript&amp;原型编程">javascript&amp;原型编程<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/ios-developer-upload/" title="ios developer upload">ios developer upload<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/nodejs/" title="nodejs">nodejs<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/docker-国内镜像/" title="docker 国内镜像">docker 国内镜像<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/docker-compose/" title="docker-compose">docker-compose<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/redis/" title="redis">redis<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/jenkins/" title="jenkins">jenkins<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/事务/" title="事务">事务<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/eureka/" title="eureka">eureka<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/elasticseach/" title="elasticseach">elasticseach<sup>1</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="http://godeggs.cn " target="_blank" title="承接手机app、微信、web开发">找人做软件</a>
            
          </li>
        
          <li>
            
            	<a href="https://kalasearch.cn" target="_blank" title="谢科的搜索引擎">谢科的搜索引擎</a>
            
          </li>
        
    </ul>
</div>

  

<div class="doubanshow">
<p class="asidetitle">豆瓣秀</p>
<div>
<script type="text/javascript" src="http://www.douban.com/service/badge/64698454/?show=collection&amp;n=12&amp;columns=3&amp;hidelogo=yes&amp;hideself=yes&amp;cat=book|movie" ></script>
</div>
</div>


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

  <div class="weiboshow">
  <p class="asidetitle">新浪微博</p>
    <iframe width="100%" height="119" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=119&fansRow=2&ptype=1&speed=0&skin=9&isTitle=1&noborder=1&isWeibo=0&isFans=0&uid=1601653200&verifier=bd864c6a&dpc=1"></iframe>
</div>


</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello ,I&#39;m Sam.This is my Blog. <br/>
			Anything that can go wrong will go wrong</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/1601653200" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		<a href="https://github.com/huguiqi" target="_blank" class="icon-github" title="github"></a>
		
		
		
		<a href="https://twitter.com/XiaoheiSpring" target="_blank" class="icon-twitter" title="twitter"></a>
		
		
		<a href="https://www.facebook.com/sam.hu.7334" target="_blank" class="icon-facebook" title="facebook"></a>
		
		
		<a href="https://www.linkedin.com/in/小黑-胡-ab83b992" target="_blank" class="icon-linkedin" title="linkedin"></a>
		
		
		<a href="https://www.douban.com/people/64698454" target="_blank" class="icon-douban" title="豆瓣"></a>
		
		
		<a href="http://www.zhihu.com/people/hu-xiao-hei-53" target="_blank" class="icon-zhihu" title="知乎"></a>
		
		
		<a href="https://plus.google.com/109318125124422212783?rel=author" target="_blank" class="icon-google_plus" title="Google+"></a>
		
		
		<a href="mailto:guiqi.hu@163.com" target="_blank" class="icon-email" title="Email Me"></a>
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="http://blog.huguiqi.com." target="_blank" title="sam">sam</a> © 2020 
		
		<a href="/about" target="_blank" title="sam">sam</a>
		
		
		</p>
</div>

 <script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');
  
  _st('install','qtnHgvQyg5N9h4en-9wA','2.0.0');
</script>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>



<script type="text/javascript">
  var duoshuoQuery = {short_name:"小黑_spring"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 


<script type="text/javascript">

var disqus_shortname = 'huguiqicom';

(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>






<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?f5971877c7b77f98074be3ddabf34fbe";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
